= 顺序流


顺序流是一个 BPMN 元素，表示活动在业务流程中的执行顺序。
定义了从一个活动到另一个活动的工作或信息的逻辑流，
表示任务或子流程的执行顺序。

顺序流连接 BPMN 图中的两个活动，
显示流程的流动方向以及活动之间的依赖关系。
顺序流在业务流程中工作流的可视化和建模中发挥着至关重要的作用，
有助于提高流程设计的清晰度和一致性。


[[graphical-flows]]
== 图形和 XML 表示

顺序流在图中展示为从出发元素到目的元素的箭头。
箭头始终指向目标。

image::bpmn-sequence-flows/graphical-flow.png[,100]

在 XML 文件中，顺序流表示为其他 BPMN 元素之间的单独对象：

[source, xml]
----
    <sequenceFlow id="Flow_1sjggq6" sourceRef="Event_15w11z6" targetRef="Gateway_0r2ejfv" />
----

可以看到，XML 中顺序流有两个属性：`sourceRef` 和 `targetRef`
表示箭头出发和目的的元素。

[[incoming-and-outgoing]]
== 传入和传出流

由于顺序流连接两个活动，第一个活动是 _传出流（outgoing）_，第二个活动是 _传入流（incoming）_。

image::bpmn-sequence-flows/incoming-outgoing-flows.png[,300]

最佳实践是每个活动只有一个传入流和传出流。

在 XML 文件中，可以在相应的 BPMN 元素中看到对顺序流的引用：

[source,xml]
----
    <task id="Activity_1pncn0v" name="Activity">
      <incoming>Flow_1tncfsd</incoming>
      <outgoing>Flow_1nxsuoi</outgoing>
    </task>
----

[[sequence-flow-properties]]
== 顺序流属性

顺序流有一些通用属性：

* Id
* Name

以及 _Condition_ 属性。（请参阅排他网关中 _condition_ 属性的详细信息）。

image::bpmn-sequence-flows/flow-properties.png[,300]


[[conditional-flow]]
== 条件顺序流

BPMN 2.0 将 _条件流（conditional flow）_ 定义为一种特殊的符号元素。
从图形上看，是一个常规的顺序流，但是连接线的开头有一个小菱形。
如图：

image::bpmn-sequence-flows/conditional-flow.png[,200]

条件流只能用作活动的 _传出_ 流。
条件在运行时进行计算，以确定该顺序流是否使用。

在 *Jmix BPM* 中，所有顺序流都可以有一个条件，但只有在必要时才会被计算和使用。

image::bpmn-sequence-flows/conditional-flow-example.png[,250]

[CAUTION]
====
*强烈建议* 不要使用条件流，因为有可能发生错误。
例如在上图中，如果条件为 _false_ 且没有其他路径可用，则流程将停止。
====


[[default-flow]]
=== 默认顺序流

所有 BPMN 2.0 任务和网关都可以有默认的顺序流。
默认的顺序流只能作为活动或网关的 _传出_ 顺序流。

默认顺序流在图中展示为为常规顺序流，开头带有“斜杠”标记。

image::bpmn-sequence-flows/default-flow.png[,150]

默认流的行为取决于所使用的元素。
默认顺序流上的条件会被忽略。


[[using-conditional-default-flows]]
=== 使用条件和默认顺序流

尽管 BPMN 规范允许使用条件流和默认流，如下图所示，但请避免这种方式的用法。
这种混用会导致图的可读性变差。

image::bpmn-sequence-flows/sequence-flow-bad-example.png[,350]

这种情况的传出流，建议使用网关：

image::bpmn-sequence-flows/using-flows-good-example.png[,450]

在此示例中，可以看到排他网关，也可以使用并行和包容网关。
