= FullCalendar 组件
:page-aliases: vcl/components/calendar.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`FullCalendar` 是一个 UI 组件，显示日期范围和日历事项。
该组件提供了管理日历事项的多种功能，并支持各种显示模式（日、周、月等）。

NOTE: 拖拽、调整大小、点击等产生的 Event，译为“事件”。日历中记录事情、会议的 Event，译为“事项”。

[cols="1h,6",grid=none]
|===

|XML 元素| `calendar`

|Java 类 |`FullCalendar`

|属性

|xref:flow-ui:vc/common-attributes.adoc#id[id] -
<<allDayMaintainDurationEnabled, allDayMaintainDurationEnabled>> -
<<allDayText, allDayText>> -
<<closeHint, closeHint>> -
xref:flow-ui:vc/common-attributes.adoc#alignSelf[alignSelf] -
xref:flow-ui:vc/common-attributes.adoc#classNames[classNames] -
xref:flow-ui:vc/common-attributes.adoc#colspan[colspan] -
xref:flow-ui:vc/common-attributes.adoc#css[css] -
<<dateAlignment, dateAlignment>> -
<<dayHeadersVisible, dayHeadersVisible>> -
<<dayMaxEventRows, dayMaxEventRows>> -
<<dayMaxEvents, dayMaxEvents>> -
<<dayOfYear, dayOfYear>> -
<<defaultAllDay, defaultAllDay>> -
<<defaultAllDayEventDuration, defaultAllDayEventDuration>> -
<<defaultBusinessHoursEnabled, defaultBusinessHoursEnabled>> -
<<defaultDayHeaderFormat, defaultDayHeaderFormat>> -
<<defaultDayMaxEventRowsEnabled, defaultDayMaxEventRowsEnabled>> -
<<defaultDayMaxEventsEnabled, defaultDayMaxEventsEnabled>> -
<<defaultDayPopoverFormat, defaultDayPopoverFormat>> -
<<defaultEventTimeFormat, defaultEventTimeFormat>> -
<<defaultSlotLabelFormat, defaultSlotLabelFormat>> -
<<defaultTimedEventDuration, defaultTimedEventDuration>> -
<<defaultWeekNumberFormat, defaultWeekNumberFormat>> -
<<direction, direction>> -
<<displayEventTime, displayEventTime>> -
<<dragRevertDuration, dragRevertDuration>> -
<<dragScroll, dragScroll>> -
<<eventBackgroundColor, eventBackgroundColor>> -
<<eventBorderColor, eventBorderColor>> -
<<eventConstraintBusinessHoursEnabled, eventConstraintBusinessHoursEnabled>> -
<<eventConstraintGroupId, eventConstraintGroupId>> -
<<eventDisplay, eventDisplay>> -
<<eventDragMinDistance, eventDragMinDistance>> -
<<eventDurationEditable, eventDurationEditable>> -
<<eventHint, eventHint>> -
<<eventInteractive, eventInteractive>> -
<<eventLongPressDelay, eventLongPressDelay>> -
<<eventMaxStack, eventMaxStack>> -
<<eventOrder, eventOrder>> -
<<eventOrderStrict, eventOrderStrict>> -
<<eventOverlap, eventOverlap>> -
<<eventResizableFromStart, eventResizableFromStart>> -
<<eventStartEditable, eventStartEditable>> -
<<eventTextColor, eventTextColor>> -
<<expandRows, expandRows>> -
<<firstDayOfWeek, firstDayOfWeek>> -
<<forceEventDuration, forceEventDuration>> -
xref:flow-ui:vc/common-attributes.adoc#height[height] -
<<initialDate, initialDate>> -
<<initialDisplayMode, initialDisplayMode>> -
xref:flow-ui:vc/common-attributes.adoc#maxHeight[maxHeight] -
xref:flow-ui:vc/common-attributes.adoc#maxWidth[maxWidth] -
xref:flow-ui:vc/common-attributes.adoc#minHeight[minHeight] -
xref:flow-ui:vc/common-attributes.adoc#minWidth[minWidth] -
<<moreLinkClassNames, moreLinkClassNames>> -
<<moreLinkDisplayMode, moreLinkDisplayMode>> -
<<moreLinkHint, moreLinkHint>> -
<<moreLinkText, moreLinkText>> -
<<navLinkHint, navLinkHint>> -
<<navigationLinksEnabled, navigationLinksEnabled>> -
<<nextDayThreshold, nextDayThreshold>> -
<<noEventsText, noEventsText>> -
<<nowIndicatorVisible, nowIndicatorVisible>> -
<<progressiveEventRendering, progressiveEventRendering>> -
<<scrollTime, scrollTime>> -
<<scrollTimeReset, scrollTimeReset>> -
<<selectConstraintBusinessHoursEnabled, selectConstraintBusinessHoursEnabled>> -
<<selectConstraintGroupId, selectConstraintGroupId>> -
<<selectLongPressDelay, selectLongPressDelay>> -
<<selectMinDistance, selectMinDistance>> -
<<selectMirror, selectMirror>> -
<<selectOverlap, selectOverlap>> -
<<selectionEnabled, selectionEnabled>> -
<<slotDuration, slotDuration>> -
<<slotLabelInterval, slotLabelInterval>> -
<<slotMaxTime, slotMaxTime>> -
<<slotMinTime, slotMinTime>> -
<<snapDuration, snapDuration>> -
<<timeHint, timeHint>> -
<<unselectAuto, unselectAuto>> -
<<unselectCancelSelector, unselectCancelSelector>> -
xref:flow-ui:vc/common-attributes.adoc#visible[visible] -
<<weekNumbersVisible, weekNumbersVisible>> -
<<weekTextLong, weekTextLong>> -
<<weekendsVisible, weekendsVisible>> -
xref:flow-ui:vc/common-attributes.adoc#width[width] -
<<windowResizeDelay, windowResizeDelay>>

|XML 内部元素
|<<business-hours-element, businessHours>> -
<<custom-display-modes-element, customDisplayModes>> -
<<data-providers-element, dataProviders>> -
<<display-mode-properties-element, displayModeProperties>> -
<<hidden-days-element, hiddenDays>>

|===

[[basic]]
== 基本用法

项目安装了该扩展组件后，`FullCalendar` 组件可以通过 Studio xref:studio:view-designer.adoc[] 中的 *Add Component* 工具箱添加。

image::add-calendar-via-studio.png[align="center"; width="765"]

添加之后，在 *Jmix UI* 结构面板和 XML 中会增加新的 `calendar:calendar` 元素。与其他 xref:flow-ui:vc/components.adoc[UI 组件] 一样，可以配置 xref:flow-ui:vc/common-attributes.adoc#id[id]、xref:flow-ui:vc/common-attributes.adoc#height[height]、xref:flow-ui:vc/common-attributes.adoc#width[width] 等属性。

[source,xml,indent=0]
----
<calendar:calendar id="calendar"
                   height="100%"
                   width="100%"/>
----

如果不使用视图设计器，则需要在 XML 中手动添加 `calendar` 命名空间：

[source,xml,indent=0]
----
<view xmlns="http://jmix.io/schema/flowui/view"
      xmlns:calendar="http://jmix.io/schema/fullcalendar/ui"
      title="Calendar view">
----

如需显示日历事项，可以将 `containerEventProvider` 绑定至 xref:flow-ui:data/data-containers.adoc[数据容器]。

下面是 `calendar` 的基本用法：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-basic.xml[tags=sample-basic1]
----

[[data-model]]
== 数据模型

[[calendar-event]]
=== CalendarEvent

`CalendarEvent` 是 `FullCalendar` 组件中事项的基类接口。提供了表示事项的一组通用属性。这些属性用来显示和管理日历中的事项。

[cols="1h,6a",grid=none]
|===
|[[id]]id
|日历事项的唯一标识符。用于在客户端标识事项。

|[[groupId]]groupId
|与其他事项共享的分组对象。相同组 ID 内的事项将自动一起拖动并调整大小。

|[[allDay]]allDay
|是否全天事项，并显示在相关 <<calendar-display-modes,显示模式>> 的 'all-day' 部分。事项默认非全天。

`null` 值表示该事项不是全天事项。

|[[startDateTime]]startDateTime
|定义事项开始的日期时间位置。类型为 `LocalDateTime`，对应系统的默认时区。对于 <<EntityCalendarEvent>>，该属性值将从支持的日期时间类型自动转换。

|[[endDateTime]]endDateTime
|定义事项结束的日期时间位置。类型为 `LocalDateTime`，对应系统的默认时区。对于 <<EntityCalendarEvent>>，该属性值将从支持的日期时间类型自动转换。

这个值是一个 *开区间*。例如，结束日期属性为 `2024-09-03` 的事项会显示在 `2024-09-02`，而不会扩展到 `2024-09-03`。

|[[title]]title
|事项的标题。

|[[description]]description
|事项的描述。

|[[interactive]]interactive
|设置是否可以使用 Tab 键遍历事项。

如果该值为 `null`，日历将根据 <<eventInteractive, eventInteractive>> 属性管理事项的交互性。

|[[classNames]]classNames
|设置事项的 CSS 类名（空格分隔）。

|[[startEditable]]startEditable
|设置事项是否可以在日历组件内拖动。

如果该值为 `null`，日历将根据 <<eventStartEditable, eventStartEditable>> 属性管理事项的拖拽功能。

|[[durationEditable]]durationEditable
|设置事项是否可以在日历组件内修改大小。

如果该值为 `null`，日历将根据 <<eventDurationEditable, eventDurationEditable>> 属性管理事项的大小调整功能。

|[[display]]display
|设置事项渲染的类型。如果没配置，则使用 `AUTO`。

|[[overlap]]overlap
|定义在拖动或调整事项大小时是否可以覆盖其他事项。并可以防止在其他事项拖拽操作时覆盖当前事项。

如果该值为 `null`，日历将根据 <<eventOverlap, eventOverlap>> 属性或特定的 JavaScript 函数管理事项的该功能。

|[[constraint]]constraint
|定义一个共享的分组标识符。该属性限制事项的拖动和调整大小在特定的单元格内。

如果该值为 `null`，日历将根据 <<eventConstraintGroupId, eventConstraintGroupId>> 或 <<eventConstraintBusinessHoursEnabled, eventConstraintBusinessHoursEnabled>> 属性管理事项的拖拽约束。

|[[backgroundColor]]backgroundColor
|设置事项的背景色。支持的值类型包括：

* 十六进制的颜色编码（例如，`#f00`, `#ff0000`）
* RGB 值（例如，`rgb(255,0,0)`）
* 颜色名称（例如，`red`）

如果该值为 `null`，日历将根据 <<eventBackgroundColor, eventBackgroundColor>> 属性管理事项的背景色。

|[[borderColor]]borderColor
|设置事项边框的颜色。支持的值类型包括：

* 十六进制的颜色编码（例如，`#f00`, `#ff0000`）
* RGB 值（例如，`rgb(255,0,0)`）
* 颜色名称（例如，`red`）

如果该值为 `null`，日历将根据 <<eventBorderColor, eventBorderColor>> 属性管理事项的边框颜色。

|[[textColor]]textColor
|设置事项文本的颜色。支持的值类型包括：

* 十六进制的颜色编码（例如，`#f00`, `#ff0000`）
* RGB 值（例如，`rgb(255,0,0)`）
* 颜色名称（例如，`red`）

如果该值为 `null`，日历将根据 <<eventTextColor, eventTextColor>> 属性管理事项的文本色。

|[[additionalProperties]]additionalProperties
|定义额外的属性和值，在以事项为参数的各种 JavaScript 函数中，可以访问这些属性。

|[[recurringDaysOfWeek]]recurringDaysOfWeek
|设置此事项在一周中的哪几天重复。如果省略，则事项每天重复。

|[[recurringStartDate]]recurringStartDate
|设置此事项的重复开始日期。如果未指定，则重复周期将往过去时间无限延伸。

|[[recurringEndDate]]recurringEndDate
|设置此事项的重复结束日期。如果未指定，则重复周期将往未来时间无限延伸。

这个值是一个 *开区间*。对于全天重复事项，需要将结束日设置为期望的结束日期加一天。

|[[recurringStartTime]]recurringStartTime
|设置重复事项的开始时间。如果未指定，则事项为全天事项。

日历不会计算该属性的时区转换。如果实体中使用了 `OffsetTime`，则转换为系统的默认时区。

|[[recurringEndTime]]recurringEndTime
|设置重复事项的结束时间。如果未指定，则事项的时长按 <<defaultTimedEventDuration, defaultTimedEventDuration>> 属性配置。
|===

[[entity-calendar-event]]
=== EntityCalendarEvent

`EntityCalendarEvent` 是 <<calendar-event, CalendarEvent>> 的实现，可用于 JPA 实体或 DTO。
当 <<container-data-provider>> 关联 xref:flow-ui:data/collection-container.adoc[集合容器] 时，会将加载的实体自动包装在 `EntityCalendarEvent` 对象中，然后传递给组件。
例如，下面的场景中所有的日历事项都是 `EntityCalendarEvent` 的实例：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-entity-calendar-event.xml[tags=sample-entity-calendar-event1]
----

因而可以转为 `EntityCalendarEvent`：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/SampleEntityCalendarEvent.java[tags=sample-entity-calendar-event2]
----

[[simple-calendar-event]]
=== SimpleCalendarEvent

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-simple-calendar-event" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

这是一个实现了 <<calendar-event, CalendarEvent>> 接口的简单 POJO 类。
可以用这个事项类替代创建 DTO 的方案或用于原型设计。
其中还有一个 builder 类，可以简化事项实例的创建过程。

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/SampleSimpleCalendarEventView.java[tags=sample-simple-calendar-event1]
----

[[recurring-events]]
=== 重复事项

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-recurring-events" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

重复事项是指按预定义的计划以固定的间隔发生多次的事项。

在 `FullCalendar` 中，可以用 `CalendarEvent` 的下列属性配置重复计划：

- <<recurringDaysOfWeek, recurringDaysOfWeek>>
- <<recurringStartDate, recurringStartDate>>
- <<recurringEndDate, recurringEndDate>>
- <<recurringStartTime, recurringStartTime>>
- <<recurringEndTime, recurringEndTime>>

如果配置了上述任何属性之一，`FullCalendar` 会认为该事项是重复事项，并忽略 <<startDateTime, startDateTime>> 和 <<endDateTime, endDateTime>> 属性的设置。

当数据 provider 指定了 `recurring*` 属性时，容器中的单个重复事项将在 `FullCalendar` 中扩展为具有自己的日期的单个事项实例。
但是，容器仍然只包含单个重复事项。

可以在数据 provider 中指定 `recurring*` 属性，如下所示：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-recurring-events-view.xml[tags=sample-recurring-events1]
----

[[recurrence-event-and-group-id]]
==== 管理重复事项

`FullCalendar` 将单个重复事项扩展为多个独立的事项实例。
这些实例都被视为独立的事项，即在默认情况下，对一个实例的更改不会影响其他实例。

*示例：移动重复事项*

假设有一个每周二举行的定期会议。如果启用了 <<eventStartEditable, eventStartEditable>> 属性，用户可以将该会议的特定实例（例如，11 月 7 日的会议）拖动到其他时间段。但是，这个更改只影响 11 月 7 日的实例。其他星期二的会议将保持原来的时间。

*重复事项分组*

如需一次移动重复事项的所有实例，则需要使用 <<calendar-event, CalendarEvent>> 的 <<groupId, groupId>> 对事项进行分组。

步骤：

. *分配 Group ID*：为所有需要一起移动的事项实例设置相同的 `groupId`。
. *启用拖拽*：设置 `eventStartEditable` 属性为 `true` 启用拖拽。

现在，当用户拖动重复事项的实例时，该组中的所有实例将同时移动，并且保持所定义的间隔。

[[days-of-week-datatype]]
==== DaysOfWeek 数据类型

<<recurringDaysOfWeek, recurringDaysOfWeek>> 属性用于定义一周内的星期几。为了在 JPA 实体和 DTO 中保存这种数据，Jmix 提供了一个专门的数据类型，称为 `DaysOfWeek`。

当为 JPA 实体或 DTO 添加属性时，Studio 会自动提供这种数据类型。然后可以为重复事项选择所需的星期。

image::add-recurring-days-of-week-attribute.png[align="center",width="871"]

xref:flow-ui:vc/components/valuePicker.adoc[] 组件和 `DaysOfWeekEditAction` 操作都支持 `DaysOfWeek` 类型。因此，在 UI 中可以很容易编辑星期几的列表。

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/app/event/event-detail-view.xml[tags=sample-days-of-week-edit-action]
----

[[data-binding]]
== 数据绑定

日历组件使用数据 provider 连接加载的数据。数据项必须实现 <<calendar-event, CalendarEvent>> 接口才能在组件中显示。对于 JPA 或 DTO 实体，<<container-data-provider>> 可以将实体包装并创建 <<EntityCalendarEvent>>。

`FullCalendar` 组件支持添加多个数据的 provider。
因此，可以在单个日历中显示来自不同数据源和服务的数据。

[[calendar-data-provider]]
=== CalendarDataProvider

`CalendarDataProvider` 是日历使用的所有数据 provider 的基类接口。
日历数据 provider 主要有两类：

* 一次加载所有数据的数据 provider。这些 provider 在一次操作中获取所有相关的数据。
* <<CallbackCalendarDataProvider>>。这些 provider 使用一个回调函数根据需要分批加载数据。

[[container-data-provider]]
=== ContainerDataProvider

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-container-calendar-data-provider" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`ContainerDataProvider` 使用 xref:flow-ui:data/data-containers.adoc[] 中的数据。
能根据容器中数据的任何变化（对实体的增、删、改）更新 `FullCalendar` 的 UI。

如需是在 `FullCalendar` 中使用容器数据 provider，需要设置：

* `dataContainer` 属性：配置为视图中已有数据容器的 ID。
* 实体属性映射。
容器数据 provider 将 JPA 或 DTO 实体包装到 <<entity-calendar-event>> 中，以便与 `FullCalendar` 组件兼容。但是并不知道知道 JPA 或 DTO 实体中的哪些属性应该用于 <<calendar-event>>。因此，必须定义属性映射指定实体属性与 `CalendarEvent` 属性的对应关系。

下面是使用 `ContainerDataProvider` 的示例：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-container-calendar-data-provider-view.xml[tags=sample-container-calendar-data-provider1]
----

如需编程式使用容器数据 provider，请使用 `ContainerCalendarDataProvider` 类。

[[list-calendar-data-provider]]
=== ListCalendarDataProvider

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-list-calendar-data-provider" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`ListCalendarDataProvider` 从提供的条目列表中获取数据。不需要 XML 定义并可以编程式添加。

下面是使用 `ListCalendarDataProvider` 的基本示例：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/SampleListCalendarDataProviderView.java[tags=sample-list-calendar-data-provider1]
----

列表数据 provider 在通过以下 API 方法进行修改后，会自动更新 `FullCalendar` UI：

* `addItem()`：添加一个条目。
* `removeItem()`：删除一个条目。
* `updateItem()`：更新一个条目。

`ListDataProvider` 中还有其他管理列表数据的方法。

[[callback-calendar-data-provider]]
=== CallbackCalendarDataProvider

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-callback-calendar-data-provider" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`CallbackCalendarDataProvider` 是按需加载数据的 provider 的基类接口。
接口定义了一个 `onItemsFetch()` 方法，每当组件需要新数据时，都会调用该方法。

在以下情况会加载数据：

* 当用户切换到日期范围更大的显示模式时。例如，用户从日视图更改为周视图，则组件将需要获取整周的数据。
* 调用 `FullCalendar` 组件的导航方法时。包括 `navigateToNext()`、`navigateToPrevious()` 以及将日历视图向前或向后移动的其他方法。
* 当 `FullCalendar` 组件的时区发生更改时。组件需要获取新数据以反映时区的变化。

[[callback-data-provider]]
=== CallbackDataProvider

使用 JPQL 和 xref:data-access:data-manager.adoc[DataManager] 加载数据的数据 provider。
与 <<container-data-provider>> 类似，也需要定义属性映射，指定实体属性与 `CalendarEvent` 属性的对应关系。
此外，还必须提供 JPQL 查询语句。

以下是 `callbackDataProvider` 元素中的属性映射示例：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-entity-calendar-data-retriever-view.xml[tags=sample-entity-calendar-data-retriever1]
----

如需使用 JPQL 加载数据，需要在数据 provider 中指定 <<items-query-element>> 元素。
该元素的 JPQL 语句中要使用实体类的完全限定名称。

`itemsQuery` 支持使用 `fetchPlan` 属性或独立的 `fetchPlan` 元素指定一个 xref:data-access:fetching.adoc#fetch-plan[FetchPlan]。

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-entity-calendar-data-retriever-view.xml[tags=sample-entity-calendar-data-retriever2]
----

JPQL 查询语句可以使用两个参数：

- `fetchStartDate` - `FullCalendar` 可见日期范围的坐边界。
- `fetchEndDate` - `FullCalendar` 可见日期范围的右边界。

NOTE: `fetchEndDate` 是个开区间。
例如，如果可见日期的范围是 `2024-09-29` 至 `2024-11-09`，则 `fetchEndDate` 需要设置为 `2024-11-10`。

使用 `callbackDataProvider` 的完整示例：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/sample-entity-calendar-data-retriever-view.xml[tags=sample-entity-calendar-data-retriever10]
----

NOTE: 该语句假定 `startDate` 和 `endDate` 不是 `null`。
如果值可能是 `null`，则需要添加对应的 `null` 检查语句。

如需编程式使用回调数据 provider，请使用 `EntityCalendarDataRetriever` 类。
这是一个 prototype 范围的 Spring bean，因此需要使用 Spring 的依赖注入机制小心地初始化。

[[callback-data-provider-and-load-delegate]]
==== 代理加载

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-callback-load-delegate" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

在复杂的业务场景下，往往需要构建多条件的 JPQL，此时在 XML 中编写查询语句会变得很麻烦。为了解决这个问题，可以为 `CallbackDataProvider` 设置一个加载数据的代理。

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/SampleEntityCalendarDataRetrieverView.java[tags=sample-entity-calendar-data-retriever4]
----

TIP: `myDataProvider` 是数据 provider 的 ID。在 XML 中通过 `id` 属性设置。

NOTE: 如果代理的实现中返回了 <<entity-calendar-event>> 的列表，则需要在数据 provider 中设置属性映射。

[[calendar-data-retriever]]
=== CalendarDataRetriever

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-calendar-data-retriever" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`CalendarDataRetriever` 一个简单的数据 provider ，与具有代理的 `callbackDataProvider` 类似。但是，不能用在 XML 中。此数据 provider 可与 service 一起使用进行数据加载，为日历组件中的数据管理提供了更灵活和编程式的方法。

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/SampleEntityCalendarDataRetrieverView.java[tags=sample-entity-calendar-data-retriever5]
----

[[calendar-display-modes]]
== 日历显示模式

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-calendar-display-modes" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

在 `FullCalendar` 中，显示模式是指日历数据的特定可视化展示方式。允许用户查看不同时间范围内的事项，例如几天、几周或几个月。这种灵活性有助于用户根据需要与各种格式的日历进行交互。例如，用户可能更喜欢一天的详细视图或整个月的事项概览。

`FullCalendar` 提供了以下内置的显示模式：

[[day-grid-modes]]
* **日网格（Day-grid）模式** 网格形式显示日历事项，类似于传统的纸质日历。日期网格中的每个单元格都表示一天。
[[dayGridDay]]
** `DAY_GRID_DAY` - 仅显示某一天，提供该特定日期事项的详细视图。
[[dayGridWeek]]
** `DAY_GRID_WEEK` - 显示一周的日历，非常适合关注即将到来的事项。
[[dayGridMonth]]
** `DAY_GRID_MONTH` - 显示一个月的日历，月内所有事项一览无余。
[[dayGridYear]]
** `DAY_GRID_YEAR` - 显示一年的日历，提供更高级别的概览。
+
使用 <<initialDisplayMode, initialDisplayMode>> 属性设置 `FullCalendar` 的初始日网格显示模式：
+
[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/day-grid-week-mode-view.xml[tags=day-grid-week-mode1]
----
+
下面的截图展示了按月显示日网格的模式：
+
image::day-grid-month-mode.png[align="center",width="1371"]

[[time-grid-modes]]
* *时间网格（Time-grid）模式* 提供按时间显示的布局，用于展示一天或多天的事项。这些格式对于需要管理其日程安排并重点关注一天中特定时间的用户特别有用。
+
`FullCalendar` 提供了两种基于时间显示的模式：
+
[[timeGridDay]]
** `TIME_GRID_DAY` - 显示一天内的详细信息，用户可以看到当天计划的所有事项，并显示事项的开始和结束时间。
[[timeGridWeek]]
** `TIME_GRID_WEEK` - 显示整个星期，提供更广的时间范围，但是每天内仍然显示时间。这个模式适合查看每周的计划或安排跨天的会议。
+
使用 <<initialDisplayMode, initialDisplayMode>> 属性设置 `FullCalendar` 的初始时间网格显示模式：
+
[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/time-grid-week-mode-view.xml[tags=time-grid-week-mode1]
----
+
下面的截图展示了按周显示时间网格的模式：
+
image::time-grid-week-mode.png[align="center",width="1110"]

[[list-modes]]
* *列表（List）模式* 以简单的垂直列表显示事项，使用户能够轻松查看和管理指定时间段内的计划。此布局适合喜欢使用简易文本显示事项的用户。
+
`FullCalendar` 提供多种列表模式：
+
[[listDay]]
** `LIST_DAY` - 显示一天的所有事项。
[[listWeek]]
** `LIST_WEEK` - 显示一周的所有事项。
[[listMonth]]
** `LIST_MONTH` - 显示一个月的所有事项。
[[listYear]]
** `LIST_YEAR` - 显示一整年的所有事项。
+
使用 <<initialDisplayMode, initialDisplayMode>> 属性设置 `FullCalendar` 的初始列表显示模式：
+
[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/list-week-mode-view.xml[tags=list-week-mode1]
----
+
下面的截图展示了按周显示事项列表的模式：
+
image::list-week-mode.png[align="center",width="780"]

[[multi-month-year]]
* **多月（Multi-months）模式** 一次展示几个月的全面视图，提供较长时间内事项的高级别概览。
+
[[multiMonthYear]]
** `MULTI_MONTH_YEAR` 显示月网格，用户可以在单一视图内看到全年的 12 个月。可以用来计划或跟踪那些跨多个月的事项。
+
使用 <<initialDisplayMode, initialDisplayMode>> 属性设置 `FullCalendar` 的初始多月显示模式：
+
[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/multi-month-year-mode-view.xml[tags=multi-month-year-mode1]
----
+
下面的截图展示了按年显示多月的模式：
+
image::multi-month-year-mode.png[align="center",width="1127"]

=== 显示模式属性

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-display-mode-specific-properties" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

每个预定义的显示模式都有其自己的一组属性。有些是通用属性，而某些属性只能用于特定的显示模式。

例如，只能为 `DAY_GRID_DAY` 模式配置 `dayHeaderFormat`，其他模式该设置无效。

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/display-mode-properties-view.xml[tags=display-mode-properties1]
----

`FullCalendar` 还支持通过显示模式的属性配置覆盖日历组件中的相同配置。

例如，假设组件启用了 <<weekNumbersVisible, weekNumbersVisible>> 属性。如果需要在 `DAY_GRID_MONTH` 显示模式中禁用这个功能，则可以按以下代码在显示模式的 `properties` 中设置：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/display-mode-properties-override-view.xml[tags=display-mode-properties-override1]
----

NOTE: 在 `name` 属性中，属性的名称需要使用 `FullCalendar.js` 中定义的名称。
参考 https://fullcalendar.io/docs#toc[FullCalendar.js 文档^] 查找正确的属性名。
请谨慎使用该功能，如果在运行时修改了 `FullCalendar` 组件的同名属性，则可能会忽略显示模式中的配置。

[[custom-calendar-display-mode]]
=== 自定义显示模式

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-custom-calendar-display-mode" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

如果预定义的显示模式不能满足要求，可以创建特定日期范围的自定义显示模式。创建自定义模式有两种方式：

* *编程式*，使用 `CustomCalendarDisplayMode` 类。
* *声明式*，在 XML 中使用 <<custom-display-modes-element,customDisplayModes>> 元素。

自定义显示模式需要基于四种基本类型之一：日网格、时间网格、列表、多月。

例如，可以用下面的代码声明式定义一个基于时间的显示模式：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/custom-display-mode-view.xml[tags=custom-display-mode1]
----

NOTE: `dayCount` 设置自定义显示模式中展示的天数，不考虑 <<weekendsVisible, weekendsVisible>> 或 <<hidden-days-element, hiddenDays>>。

也可以用 `duration` 元素替换 `dayCount` 指定日期范围：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/custom-display-mode-view.xml[tags=custom-display-mode2]
----

NOTE: 当使用 `duration` 定义日期范围时，隐藏的日期会不显示，该模式会拉升视图以填满缺失天数的空间。
但是，如果用 `dayCount`，则必然会显示特定数量的天数。

如需编程式创建自定义模式，请使用 `CustomCalendarDisplayMode` 类。

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/displaymode/CustomDisplayModeView.java[tags=custom-display-mode3]
----

TIP: 默认的显示模式是日网格模式，可以从 `GenericCalendarDisplayModes` 枚举中选择其他类型修改这一行为。

[[display-mode-and-visible-range]]
=== 显示模式和可见范围

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-generic-calendar-display-modes" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

日历中显示的日期范围可以进一步通过 `visibleRange` 属性进行自定义。该属性的使用需要结合 `GenericCalendarDisplayModes` 枚举中所选的类型。

WARNING: `visibleRange` 没有 XML 定义，只能以编程的方式设置。

例如，可以这样配置日历显示的日网格：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/displaymode/visible-range-view.xml[tags=visible-range1]
----

TIP: `GenericCalendarDisplayModes` 枚举提供 XML 中可用的这些选项：`DAY_GRID`、`TIME_GRID`、`LIST` 和 `MULTI_MONTH`。

在视图控制器设置需要显示的日期范围：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/displaymode/VisibleRangeView.java[tags=visible-range2]
----

NOTE: 后一个日期是开区间。
例如，配置 2024 年 10 月 1 日至 2024 年 10 月 3 日的范围仅显示两天（1 日和 2 日）。

NOTE: 当设置了可见范围后，类似 `navigateToNext()` 的导航方法将无效。

[[calendar-event-editing]]
== 编辑日历事项

`FullCalendar` 支持通过拖拽的方式编辑日历事项的开始日期，改变事项大小的方式修改时长。如需处理这些改动，可以添加 <<EventDropEvent, EventDropEvent>> 和 <<EventResizeEvent, EventResizeEvent>> 的事件监听器。

组件仅能修改日历事项 <<calendar-event, CalendarEvent>> 的三个属性：

* <<startDateTime, startDateTime>>
* <<endDateTime, endDateTime>>
* <<allDay, allDay>>

[[drag-and-drop]]
=== 拖拽

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-event-start-editable" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

如需启用拖拽功能，请设置 <<eventStartEditable, eventStartEditable>> 为 `true`。

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/eventedit/event-edit-code-samples-view.xml[tags=event-edit-drag-and-drop1]
----

[[event-drop-event]]
==== 放置事件

如需处理放置事项时产生的更改，需要订阅 <<EventDropEvent, EventDropEvent>>。
当用户将一个日历事项移至不同的位置时，`FullCalendar` 组件会发出该事件。

NOTE: 在向监听器发送事件之前，组件会先将数据改动应用在数据 provider 中。

放置事件包含下列信息：

* 被放置的日历事项
*日历事项的数据 provider
* 旧值
* 当前的显示模式信息
* 新旧开始时间的间隔（时长）
* 与放置的日历事项同步放置的其他相关日历事项

下面的示例演示了如何保存实体日历事项的更改：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/eventedit/EventDragAndDropView.java[tags=event-edit-drag-and-drop2]
----

[[resizable]]
=== 尺寸可调

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-event-duration-editable" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

要启用日历事项大小调整，请设置 <<eventDurationEditable, eventDurationEditable>> 属性为 `true`。用户可以修改日历事项的结束日期来更改其持续时间（尺寸）。

要通过修改日历事项的开始日期来调整日历事项的大小，请设置<<eventResizableFromStart, eventResizableFromStart>> 属性为 `true`：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/eventedit/event-edit-code-samples-view.xml[tags=event-edit-resizable1]
----

[[event-resize-event]]
==== 调节尺寸事件

如需处理日历事项调整大小产生的更改，需要订阅 <<EventResizeEvent, EventResizeEvent>>。
当用户调整日历事项的大小时，`FullCalendar` 组件会发出该事件。

NOTE: 在向监听器发送事件之前，组件会先将数据改动应用在数据 provider 中。

尺寸调整事项包含下列信息：

* 调整大小后的日历事项
*日历事项的数据 provider
* 旧值
* 当前的显示模式信息
* 新旧开始时间的间隔（时长）
* 新旧结束时间的间隔（时长）
* 与调整大小的日历事项同步调整的其他相关日历事项

下面的示例演示了如何保存实体日历事项的更改：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/eventedit/EventResizeView.java[tags=event-edit-resizable2]
----

[[calendar-event-constraints]]
=== 日历事项约束

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-event-constraint" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`FullCalendar` 可以配置对拖拽和调整大小的限制。
有三种限制的方式：

* *事项约束 Group ID*：
+
设置 <<eventConstraintGroupId, eventConstraintGroupId>>。如果设置了该属性，则同一 group ID 内的所有事项在拖动或调整大小时，不能超出该组中日期时间范围最大的那个。

* *默认工作时间*：
+
使用 <<eventConstraintBusinessHoursEnabled, eventConstraintBusinessHoursEnabled>> 属性启用默认工作时间。在拖动或调整事项的大小时，事项必须位于工作时间内。
如果设置了 <<defaultBusinessHoursEnabled, defaultBusinessHoursEnabled>>，则默认的工作时间是从周一至周五，上午 9 点至下午 5 点。也支持自定义的工作时间。

* *自定义工作时间*：
+
设置自定义工作时间。与默认工作时间一样，事项必须包含在自定义的工作时间内。

[[event-overlap]]
=== 日历事项重叠

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-event-overlap-function" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

<<eventOverlap, eventOverlap>> 属性提供了另一种限制日历事项拖动和调整其大小的办法。该属性控制事项在拖动或调整大小时是否可以相互重叠。默认情况下，事项可重叠。

如需进行更精细的控制，还可以使用 JavaScript 函数自定义重叠规则。

以下示例演示仅允许全天日历事项之间可以重叠：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/eventedit/EventOverlapView.java[tags=event-edit-event-overlap1]
----

NOTE: JavaScript 函数定义的重叠规则优先级高于 <<eventOverlap, eventOverlap>> 属性。

TIP: 事项的所有属性可在 https://fullcalendar.io/docs/event-object[FullCalendar.js 文档^] 中查看。在 JavaScript 函数中，还可以使用事项的 `extendedProps` 对象提供的 <<additionalProperties, additionalProperties>>。例如，如果日历事项具有一个名为 `myEventStatus` 的附加属性，则以按如下方式读取值：`stillEvent.extendedProps.myEventStatus`。

[[selection]]
== 选择

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-selection" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`FullCalendar` 中的选择功能允许用户通过单击或拖动鼠标来选择多个日期或时间段。要启用此功能，设置 <<selectionEnabled, selectionEnabled>> 属性为 `true`：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/selection/selection-code-samples-view.xml[tags=selection-basic1]
----

[[select-event]]
=== 选择事件

如需处理选择事件，请订阅 <<SelectEvent, SelectEvent>>。
该事件在用户选择多个日期或时段时，由 `FullCalendar` 组件触发。

该事件包含以下信息：

* 开始日期和时间
* 结束日期和时间
* `allDay` 属性。可以用来判断选择的是日期还是时间段。
* 关于当前显示模式的信息
* 关于鼠标点击的信息

订阅选择事件的示例：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/selection/SelectionSelectEventView.java[tags=selection-select-event1]
----

NOTE: 结束日期和时间是 *开区间*。例如，如果选择的是全天并且最后选择的日期是 `2024-10-15`，则结束日期属性的值为 `2024-10-16`。

[[unselect-event]]
=== 反选事件

如需处理反选操作，需要订阅 <<UnselectEvent, UnselectEvent>>。
当清除选择时，`FullCalendar` 组件会发出该事件。
有以下场景：

* 用户点击当前选择区域外的位置，该功能需要禁用 <<unselectAuto, unselectAuto>> 属性。
* 用户选择了新的内容：事件在新内容选择发生前触发。
* 用户在日历视图中向前/后移动，或切换到其他显示模式。
* `unselect()` 方法被调用。

该事件包含以下信息：

* 关于当前显示模式的信息
* 关于鼠标点击的信息

订阅反选事件的示例：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/selection/SelectionUnselectEventView.java[tags=selection-unselect-event1]
----

[[select-constraints]]
=== 选择约束

`FullCalendar` 中的选择约束与 <<calendar-event-constraints>> 类似，但是两者应用在不同的可选择区域。选择约束基于下列属性限制可选区域：

* <<selectConstraintGroupId, selectConstraintGroupId>> 属性：如果设置了该属性，则只能选择所设置的组 ID 的事项所在的日期或时间段。
* <<selectConstraintBusinessHoursEnabled, selectConstraintBusinessHoursEnabled>> 属性：只能在一周的工作时间内进行选择。如果设置了 <<defaultBusinessHoursEnabled, defaultBusinessHoursEnabled>>，默认的工作时间是周一至周五，早上 9 点至下午 5 点。也支持自定义的工作时间。
* 自定义工作时间：与默认工作时间一样，只能在自定义工作时间内选择。

[[select-overlap]]
=== 选择重叠

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-select-overlap-function" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

<<selectOverlap, selectOverlap>> 属性提供限制选择的另一中方式。用于控制选择的区域是否可以和已有的日历事项重叠。默认允许重叠。

如需进行更精细的控制，还可以使用 JavaScript 函数检查选择区域与事项的重叠。

以下示例演示如何允许在包含背景日历事项的单元格中进行选择：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/selection/SelectionSelectOverlapView.java[tags=selection-select-overlap1]
----

NOTE: JavaScript 函数定义的选择重叠优先级高于 <<selectOverlap, selectOverlap>> 属性。

TIP: 事项的所有属性可在 https://fullcalendar.io/docs/event-object[FullCalendar.js 文档^] 中查看。
在 JavaScript 函数中，还可以使用事项的 `extendedProps` 对象提供的 <<additionalProperties, additionalProperties>>。
例如，如果日历事项具有一个名为 `myEventStatus` 的附加属性，则以按如下方式读取值：`stillEvent.extendedProps.myEventStatus`。

[[programmatic-selection-control]]
=== 编程式选择控制

`FullCalendar` 提供下列方法，可以编程式选择或反选日期范围：

* `select()`：: 选择日期范围。
* `unselect()`：清除当前的选择。

下面的代码选择了 2 天，包括今天：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/selection/SelectionProgrammaticSelectionControlView.java[tags=selection-programmatic-selection-control1]
----

NOTE: 上面示例中的结束时间是一个 *开区间*。

[[control-selection-by-a-javascript-function]]
==== 用 JavaScript 函数控制选择

可以使用 JavaScript 函数控制每个单元格的选择行为。例如，以下函数仅启用昨天、今天和明天的选择：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/selection/SelectionSelectAllowFunctionView.java[tags=selection-select-allow-function1]
----
<1> 函数的 `selectionInfo` 参数包含下列属性：
* `allDay`: Boolean 类型，是否选择全天单元格。
* `end`: Date 类型，表示选择的结束日期（开区间）。
* `endStr`: 字符串形式的结束日期。
* `start`: Date 类型，表示选择的开始日期。
* `startStr`: 字符串形式的开始日期。

<2> 设置可选的 `start`、`end` 日期。
<3> 该方法使用组件的时区将 `LocalDate` 转换为 ISO 格式。

[[business-hours]]
== 工作时间

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-business-hours" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

工作时间是指可以计划或显示事项的特定时间。有两种方法可以在 `FullCalendar` 组件中配置工作时间：

* <<defaultBusinessHoursEnabled, defaultBusinessHoursEnabled>> 属性。
* 自定义工作时间列表。可以覆盖默认的配置。

下面是用 `defaultBusinessHoursEnabled` 属性配置的示例：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/businesshours/business-hours-code-samples-view.xml[tags=business-hours-code-samples1]
----

日历中的工作时间会高亮（默认白色）显示。

image::business-hours-enabled.png[align="center",width="878"]

要对工作时间进行更精细的控制，可以设置自定义工作时间列表。支持为一周中的不同日期配置不同的时间，还可以将工作时间分为多个时段（如早班和下午班）。

我们设置一个值班时间表作为示例。周一、三、五的工作时间为上午 8 点至中午 12 点，而周二和周四的工作时间为中午 12 点至下午 6 点：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/businesshours/business-hours-code-samples-view.xml[tags=business-hours-code-samples2]
----

NOTE: `startTime` 和 `endTime` 属性使用 ISO-8601 时长定义的格式，与 `java.time.Duration` 类使用的格式相同。

image::business-hours-custom.png[align="center",width="1048"]

[[context-menu]]
== 上下文菜单

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-context-menu" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`FullCalendar` 组件通过 `FullCalendarContextMenu` 类提供上下文菜单。
可以根据单击的日期单元格或日历事项自定义菜单的内容。

但是，上下文菜单的使用有一定限制：

* *日历事项*：在所有显示模式下都可用。
* *日单元格*：在所有日网格显示模式和多月年模式中可用。
* *时间段*： 不可用。

动态上下文菜单处理示例：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/contextmenu/ContextMenuMenuContentView.java[tags=context-menu-menu-context1]
----
<1> 从 `FullCalendar` 组件获取上下文菜单实例。
<2> 设置上下文菜单的处理方法，方法中也可以配置菜单项。
<3> 删除菜单中的所有项目。
<4> 添加新菜单项，以及点击事件监听器。
<5> 返回 `true` 表示上下文菜单可以打开。

image::context-menu.png[align="center",width="445"]

[[styling]]
== 样式

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-event-styling" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

可以使用 CSS 设置日历和事项的样式。
通过浏览器的开发工具可以找到日历的 DOM 树并编写 CSS 选择器。

例如，以下选择器在日网格模式下更改星期六和星期日的背景颜色：

[source,css,indent=0]
----
include::example$fullcalendar-ex2/src/main/frontend/themes/fullcalendar-sample/styling-css-samples.css[tags=styling-css1]
----

`FullCalendar.js` 提供了下列 CSS 变量，可以用于自定义：

[source,css,indent=0]
----
include::example$fullcalendar-ex2/src/main/frontend/themes/fullcalendar-sample/styling-css-samples.css[tags=styling-css-variables1]
----

[[component-and-event-properties]]
=== 组件和事项的属性

`FullCalendar` 组件和日历事项包含特定的属性，可以定义事项的颜色。

例如，下面的代码为所有的日历事项设置颜色：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/styling/styling-properties-view.xml[tags=styling-properties1]
----

image::styling-properties1.png[align="center",width="185"]

单独的日历事项的属性可以覆盖组件的颜色定义：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/styling/StylingPropertiesView.java[tags=styling-properties2]
----

image::styling-properties2.png[align="center",width="149"]

另一个修改事项样式的方式就是为其分配 CSS 类名。这样可以为特定的事项设置样式。

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/styling/StylingPropertiesView.java[tags=styling-properties3]
----

CSS 选择器：

[source,css,indent=0]
----
include::example$fullcalendar-ex2/src/main/frontend/themes/fullcalendar-sample/styling-css-samples.css[tags=styling-properties4]
----

image::styling-properties3.png[align="center",width="186"]

[[class-names-generators]]
=== 类名生成器

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/calendar-class-names-generator" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

使用类名生成器可以根据日历 UI 元素产生的上下文生成 CSS 类名。

例如，我们可以使用 <<dayHeaderClassNamesGenerator, dayHeaderClassNamesGenerator>> 高亮周末：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/styling/StylingDayHeaderClassNamesGeneratorView.java[tags=styling-day-header-class-names-generator1]
----

添加 2 个 CSS 选择器设置背景和文字颜色：

[source,css,indent=0]
----
include::example$fullcalendar-ex2/src/main/frontend/themes/fullcalendar-sample/styling-css-samples.css[tags=styling-day-header-class-names-generator2]
----

image::styling-day-header-class-names-generator1.png[align="center",width="879"]

参阅 <<handlers>> 部分了解所有可用的类名生成器。

[[localization]]
== 本地化

本地化功能支持为单一 `FullCalendar` 组件设置本地化或者使用 `messages` 机制进行全局本地化。

如需配置单个组件的本地化，使用组件属性和 `FullCalendarI18n` 对象。
`FullCalendarI18n` 对象包含与区域设置相关的属性，其中一些属性会影响组件的行为，例如 <<firstDayOfWeek, firstDayOfWeek>>、<<direction, direction>> 等。

示例，我们更改一周的第一天和方向：

[source,xml,indent=0]
----
include::example$fullcalendar-ex2/src/main/resources/com/company/fullcalendarsample/view/demos/localization-single-component-view.xml[tags=localization-single-component1]
----

以下是编程式设置：

[source,java,indent=0]
----
include::example$fullcalendar-ex2/src/main/java/com/company/fullcalendarsample/view/demos/LocalizationSingleComponentView.java[tags=localization-single-component2]
----

如需修改全局的本地化设置，请添加 `FullCalendar` 扩展组件内的消息键值到应用程序的消息包内。完整的消息键值可以在 https://github.com/jmix-framework/jmix/blob/1e61c4f49db9d31045b421a4d0f33e8137a32542/jmix-translations/content/io/jmix/fullcalendarflowui/messages.properties[jmix/fullcalendarflowui/messages.properties^] 找到。

例如，可以添加下面的月和星期的本地化：

[source,properties,indent=0]
----
io.jmix.fullcalendarflowui.component/months=一月, 二月, 三月, 四月, 五月, 六月, 七月, 八月, 九月, 十月, 十一月, 十二月
io.jmix.fullcalendarflowui.component/monthsShort=一, 二, 三, 四, 五, 六, 七, 八, 九, 十, 十一, 十二
io.jmix.fullcalendarflowui.component/weekdays=星期日, 星期一, 星期二, 星期三, 星期四, 星期五, 星期六
io.jmix.fullcalendarflowui.component/weekdaysShort=日, 一, 二, 三, 四, 五, 六
io.jmix.fullcalendarflowui.component/weekdaysMin=日, 一, 二, 三, 四, 五, 六
----

NOTE: 确保翻译后的名称与原始名称的顺序相同，因为解析器期望的顺序是，星期从星期日到星期六，月份从 1 月到 12 月。

[[attributes]]
== 属性

在 Jmix 中，所有组件都有一些作用一致的 xref:flow-ui:vc/common-attributes.adoc[通用属性]。
下面是 `calendar` 的特殊属性：

[cols="1h,7a,1",grid=rows,frame=none]
|===
|*名称*|*描述*|*默认值*

|[[allDayMaintainDurationEnabled]]allDayMaintainDurationEnabled
| 当事项从一个时间的区域拖拽至全天区域或相反操作时，用该参数确定如何修改事项的时长。

- `true` - 保持时长大致相同。“大致” 是因为如果事项的持续时间精确到小时，则四舍五入到最接近的全天。
- `false` - 事项放置至全天区域时，时长将重置为 <<defaultAllDayEventDuration, defaultAllDayEventDuration>>，如果放置于时间区域，则重置为 <<defaultTimedEventDuration, defaultTimedEventDuration>>
| `false`

|[[allDayText]]allDayText
| 设置全天的文本，在时间网格显示模式时可见。
|-

|[[closeHint]]closeHint
|设置当点击“更多（more）”链接时弹出窗口中的关闭按钮的提示。
|-

|[[dateAlignment]]dateAlignment
|设置 <<custom-calendar-display-mode, 自定义显示模式>> 的第一个可见日期。

当使用自定义日历显示模式时，如果希望日历以某个特定的间隔开始（如周初或月初），那么请设置为 `week` 或 `month`。如果未设置该属性，则将根据显示模式的日期范围生成合理的默认值。

如果显示模式的范围已经由可见日期的范围明确定义，则将忽略该属性。
|-

|[[dayHeadersVisible]]dayHeadersVisible
|设置是否应显示日期标题。适用于日网格、时间网格和月份显示模式。
|`true`

|[[dayMaxEventRows]]dayMaxEventRows
|设置日网格显示模式下事项的行数，在时间网格显示模式下，则设置“全天”区域中的事项行数。

注意，这里的计数包括 “+more” 链接行。例如，如果值设置为 `1`，则仅显示 “+more”。优先级高于 <<defaultDayMaxEventRowsEnabled, defaultDayMaxEventRowsEnabled>>。
|-

|[[dayMaxEvents]]dayMaxEvents
|设置日网格显示模式下事项的行数，在时间网格显示模式下，则设置“全天”区域中的事项行数。

注意，这里的计数不包括 “+more” 链接行。例如，如果值设置为 `1`，则显示一条事项，以及 “+more” 行。优先级高于 <<defaultDayMaxEventsEnabled, defaultDayMaxEventsEnabled>>。
|-

|[[dayOfYear]]dayOfYear
|设置定义每年第一周的规则。例如，如果一周的第一天是 `1`，day of year 等于 `4`，则包含 `1 月 4 日` 的周是一年的第一周。
|-

|[[defaultAllDay]]defaultAllDay
|设置每个日历事项 <<allDay, allDay>> 属性的默认值。

如果该属性设置为 `true`，则所有未设置 <<allDay, allDay>> 属性的事项（例如，未在数据 provider 中设置映射或日历事项的该属性为 `null`）将被视为全天事项。

请注意，在这种情况下，没有 <<allDay, allDay>> 属性的事项将显示为全天事项。如果通过拖动或调整大小来修改了这类事项，并且有事件监听器，则组件会将更改应用于日历事项，从而导致修改实体或 DTO 实例。
|`false`

|[[defaultAllDayEventDuration]]defaultAllDayEventDuration
|在事项未设置 <<endDateTime, endDateTime>> 属性时，设置全天事项的默认时长。

例如，假设该属性设置为 2 天。则 <<allDay, allDay>> 属性为 `true` 的事项如果没有设置 <<endDateTime, endDateTime>>，将显示在全天区域并且占据 2 天。

请注意，日历事项的 <<endDateTime, endDateTime>> 一般不设置，除非 <<forceEventDuration, forceEventDuration>> 为 `true`。此时，日历会为事项显式设置一个结束时间。如果通过拖动或调整大小来修改了这类事项，并且有事件监听器，则组件会设置日历事项的结束时间，从而导致修改实体或 DTO 实例。

该属性仅影响 <<allDay, allDay>> 为 `true` 的事项（全天事项）。
|`P1d`

|[[defaultBusinessHoursEnabled]]defaultBusinessHoursEnabled
|启用默认的工作时间。默认工作时间范围：`星期一 - 星期五` 的 `9 AM` 至 `5 PM`。
|`false`

|[[defaultDayHeaderFormat]]defaultDayHeaderFormat
|设置日历列标题上显示文本的默认格式。

默认情况下，组件在创建时从 `messages` 读取并设置本地化格式。
该属性是所有显示模式和 <<custom-calendar-display-mode, CustomCalendarDisplayMode>> 的默认格式。但是，所有显式模式的属性对象都设置了特定的格式，因此会覆盖该属性的设置。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。例如，`dd` 表示缩写的星期，会输出 `Mo`。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[defaultDayMaxEventRowsEnabled]]defaultDayMaxEventRowsEnabled
| 限制给定日期内堆叠事项的最大数量。

- `true` - 按日期单元格的高度限制事项数。
- `false` - 组件按原样显示所有事项。

该属性适用于日网格显示模式和全天单元格。
|`false`

|[[defaultDayMaxEventsEnabled]]defaultDayMaxEventsEnabled
| 限制给定日期内堆叠事项的最大数量。

- `true` - 按日期单元格的高度限制事项数。
- `false` - 组件按原样显示所有事项。

该属性适用于日网格显示模式和全天单元格。
|`false`

|[[defaultDayPopoverFormat]]defaultDayPopoverFormat
|设置点击“更多（more）”链接弹出窗口标题的日期格式。默认情况下，组件在创建时从 `messages` 读取并设置本地化格式。

该属性是所有显示模式和 <<custom-calendar-display-mode, CustomCalendarDisplayMode>> 的默认格式。但是，所有显式模式的属性对象都设置了特定的格式，因此会覆盖该属性的设置。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。例如，`MMM D, YY` 会输出 `Sep 9, 24`。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[defaultEventTimeFormat]]defaultEventTimeFormat
|设置每个事项显示的时间文本格式。默认情况下，组件在创建时从 `messages` 读取并设置本地化格式。

该属性是所有显示模式和 <<custom-calendar-display-mode, CustomCalendarDisplayMode>> 的默认格式。但是，所有显式模式的属性对象都设置了特定的格式，因此会覆盖该属性的设置。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。例如，`HH:mm` 会输出 `00:00`（01, 2, ... 23 : 01, 02 ... 59）。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[defaultSlotLabelFormat]]defaultSlotLabelFormat
|设置显示在时间段内的文本格式。默认情况下，组件在创建时从 `messages` 读取并设置本地化格式。

该属性是所有显示模式和 <<custom-calendar-display-mode, CustomCalendarDisplayMode>> 的默认格式。但是，所有显式模式的属性对象都设置了特定的格式，因此会覆盖该属性的设置。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。例如，`ha` 会输出 `1 am`（1, 2, ... 12 am/ pm）。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[defaultTimedEventDuration]]defaultTimedEventDuration
|设置事项的默认时长，在事项未设置 <<endDateTime, endDateTime>> 属性时使用。

例如，该属性设置为 2 小时。则 <<allDay, allDay>> 属性为 `false` 且没有设置 <<endDateTime, endDateTime>> 属性的事项默认占据 2 小时的时间段。

请注意，即使在上述情况下，日历事项的 <<endDateTime, endDateTime>> 属性仍然未设置，除非 <<forceEventDuration, forceEventDuration>> 为 `true`。此时，日历会显式地为事项设置一个结束时间。如果通过拖动或调整大小来修改了这类事项，并且有事件监听器，则组件会修改日历的 <<endDateTime, endDateTime>>，从而导致修改实体或 DTO 实例。

该属性仅影响 <<allDay, allDay>> 为 `false` 的事项（非全天事项）。
|`PT1h`

|[[defaultWeekNumberFormat]]defaultWeekNumberFormat
|设置星期序号的格式，当 <<weekNumbersVisible, weekNumbersVisible>> 为 `true`时。默认情况下，组件在创建时从 `messages` 读取并设置本地化格式。

该属性是所有显示模式和 <<custom-calendar-display-mode, CustomCalendarDisplayMode>> 的默认格式。但是，所有显式模式的属性对象都设置了特定的格式，因此会覆盖该属性的设置。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。例如，`[Week] w` 会输出 `Week 1`（1, 2, ... 52, 53）。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[direction]]direction
|文本的方向。设置该属性也会导致组件重新布局。
|-

|[[displayEventTime]]displayEventTime
|设置每个事项时间文本的可见性。

该属性应用在时间事项（非全天事项）上。支持的值为 `true`（显示时间文本） 和 `false`。全天事项不显示时间文本。
|`true`

|[[dragRevertDuration]]dragRevertDuration
|设置当拖动事项失败后，其恢复到原始位置所需的时间。
|`500`

|[[dragScroll]]dragScroll
|启用此选项可在事项拖放和日期选择时自动滚动布局。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`true`

|[[eventBackgroundColor]]eventBackgroundColor
|设置日历中所有事项的背景颜色。

请注意，如果日历事项设置了 <<backgroundColor, backgroundColor>> 属性，则可以覆盖此值。

支持的值类型：

- `#f00`
- `#ff0000`
- `rgb(255,0,0)`
- 颜色名称 - `red`
|-

|[[eventBorderColor]]eventBorderColor
|设置日历中所有事项的边框颜色。

请注意，如果日历事项设置了 <<borderColor, borderColor>> 属性，则可以覆盖此值。


支持的值类型：

- `#f00`
- `#ff0000`
- `rgb(255,0,0)`
- 颜色名称 - `red`
|-

|[[eventConstraintBusinessHoursEnabled]]eventConstraintBusinessHoursEnabled
|设置正在拖动或调整大小的事项是否必须完全包含在一周的工作时间内。也会遵循自定义工作时间的设置。
| `false`

|[[eventConstraintGroupId]]eventConstraintGroupId
|设置组 ID 以限制事项的拖动和大小调整。正在拖动或调整大小的事项必须完全包含在同一组内的至少一个事项范围内。

优先级高于 <<eventConstraintBusinessHoursEnabled, eventConstraintBusinessHoursEnabled>>。

组 ID 可以是实体实例、字符串、枚举或其他类型。
|-

|[[eventDisplay]]eventDisplay
|设置显示模式，该模式控制所有未指定显示模式事项的外观。

如需控制特定事项的显示模式，请使用日历事项的 <<display, display>> 属性。
|`AUTO`

|[[eventDragMinDistance]]eventDragMinDistance
|设置在开始拖动事项前，用户的鼠标、触摸板必须移动的像素数。
|`5`

|[[eventDurationEditable]]eventDurationEditable
|启用可以通过调整大小变更事项时长的功能。该属性可以被事项级别的 <<durationEditable, durationEditable>> 属性覆盖。
|`false`

|[[eventHint]]eventHint
|在列表显示模式中，为不可见的表头设置带有事项名称的列名。
|-

|[[eventInteractive]]eventInteractive
|允许通过调整大小来编辑事项的持续时间。

该属性可以被事项级别的 <<interactive, interactive>> 属性覆盖。
|`false`

|[[eventLongPressDelay]]eventLongPressDelay
|设置在触摸设备中，用户必须长按才能拖动事项的时长，单机为毫秒。
|`1000`

|[[eventMaxStack]]eventMaxStack
|设置时间网格显示模式中从上到下堆叠的最大事项数。
|-

|[[eventOrder]]eventOrder
|设置可参与排序的日历事项属性列表。也可以是事项 <<additionalProperties, additionalProperties>> 中的属性。

对于大多数日历显示模式，该属性确定同一天内事项的垂直顺序。但是，对于时间网格显示模式，该属性确定同一时隙内事项的水平顺序。

属性的默认值会将更早的事项放在前面。如果开始时间一样，则时长较长的事项放在前面。如果时长仍然一样，则全天事项放在前面。如果全天属性也一样，则按标题和字母顺序对事项进行排序。

在排序的过程中，如果将一个本该排在后面的事项放到前面可以看起来更紧凑，则算法会这样做。如需禁用此行为，请将 <<eventOrderStrict, eventOrderStrict>> 设置为 `true`。

选择的属性按升序排序。如果属性带减号前缀（如 `-title`），则表示按降序排序。
|`start,-duration,allDay,title`

|[[eventOrderStrict]]eventOrderStrict
|组件严格按照事项的顺序排序。

`false` 值表示事项的不会严格排序，而是将组件展示的紧凑性优先于排序进行考虑。
|`false`

|[[eventOverlap]]eventOverlap
|在拖拽和调整大小时允许事项之间重叠。
|`true`

|[[eventResizableFromStart]]eventResizableFromStart
|启用可以从事项开始时间调整事项的大小。
|`false`

|[[eventStartEditable]]eventStartEditable
|启用可以通过拖动来编辑事项的开始时间。

该属性可以被事项级别的 <<startEditable, startEditable>> 属性覆盖。
|`false`

|[[eventTextColor]]eventTextColor
|设置日历中所有事项的文字颜色。

该属性可以被事项级别的 <<textColor, textColor>> 属性覆盖。

支持的值类型：

- `#f00`
- `#ff0000`
- `rgb(255,0,0)`
- 颜色名称 - `red`

该颜色应用于时间网格显示模式，以及日期网格显示模式下的全天事项。
|-

|[[expandRows]]expandRows
|在时间网格显示模式中，如果时间段的高度不占据整个高度的话，则扩展至整个高度。
|`false`

|[[firstDayOfWeek]]firstDayOfWeek
|设置每周的第一天。默认值从 locale 中获取。
|-

|[[forceEventDuration]]forceEventDuration
|如果事项没有设置 <<endDateTime, endDateTime>> 属性，则组件会强制为其设置。

请注意，如果日历事项的 <<endDateTime, endDateTime>> 属性未设置，日历会显式地为事项设置一个结束时间。如果通过拖动或调整大小来修改了这类事项，并且有事件监听器，则组件会修改日历的 <<endDateTime, endDateTime>>，从而导致修改实体或 DTO 实例。
|`false`

|[[initialDate]]initialDate
|设置当组件 attach 到 UI 时显示的初始日期。如果未指定，则使用当前日期。

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[initialDisplayMode]]initialDisplayMode
|设置当组件 attach 到 UI 后的日历显示模式。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`DAY_GRID_MONTH`

|[[moreLinkClassNames]]moreLinkClassNames
|设置 “more” 链接的 CSS 类名。
|-

|[[moreLinkDisplayMode]]moreLinkDisplayMode
|设置当点击 “more” 链接时的日历显示模式。
|-

|[[moreLinkHint]]moreLinkHint
|设置 “more” 链接的提示信息。设置的内容可以是 https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals[JavaScript 模板字符串^]。模板中可以使用 `Number` 类型的 `count` 参数，示例：

[source,java]
----
setMoreLinkHint("Show ${count} more event${count === 1 ? '' : 's'}");
----

也可以设置为一个 JavaScript 的函数，该函数的参数为 `count`。示例：

[source,java]
----
setMoreLinkHint("function (count) { return `Show ${count} more event${count === 1 ? '' : 's'}`; }");
----
|-

|[[moreLinkText]]moreLinkText
|设置 “more” 链接的文本。设置的内容可以是 https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals[JavaScript 模板字符串^]。模板中可以使用 `Number` 类型的 `count` 参数，示例：

[source,java]
----
setMoreLinkText("+${count} event(s)");
----

也可以设置为一个 JavaScript 的函数，该函数的参数为 `count`。示例：

[source,java]
----
setMoreLinkText("function (count) { return `See +${count} event` + (count === 1 ? '' : 's'); }");
----
|-

|[[navLinkHint]]navLinkHint
|设置导航链接的提示文本。设置的内容可以是 https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals[JavaScript 模板字符串^]。模板中可以使用 `String` 类型的 `date` 参数，示例：

[source,java]
----
setNavLinkHint("Navigate to ${date}");
----

也可以设置为一个 JavaScript 的函数，该函数的参数为 `String` 类型的 `date`。示例：

[source,java]
----
setNavLinkHint("function (date) { return `Navigate to ${date}`; }");
----
|-

|[[navigationLinksEnabled]]navigationLinksEnabled
|可以用日期名称和星期名称导航。
|`false`

|[[nextDayThreshold]]nextDayThreshold
|设置日期的时间分隔线。事项的 <<endDateTime, endDateTime>> 在该设置之前的视为前一天的事项。

示例，该属性的配置为 `09:00:00`。假设有一个事项的时间是：

- 开始时间 - `2024-09-01T20:00:00`；
- 结束时间 - `2024-09-02T02:00:00`；

显然，这个事项是跨天了，但是由于结束时间仍然在 `nextDayThreshold` 属性设置的时间之前，因此还是按照一天内的事项渲染。如果事项的结束时间是 `2024-09-02T10:00:00`，则渲染为一个跨 2 天的事项。

该属性仅对显示整天单元格的时间事项有效。全天单元格出现在日网格显示模式中，全天时段出现在时间网格显示模式。

请注意，当事项的 <<allDay, allDay>> 属性设置为 `true` 时，将忽略此属性。
|-

|[[noEventsText]]noEventsText
|设置在列表显示模式下不显示任何事项时显示的文本。
|-

|[[nowIndicatorVisible]]nowIndicatorVisible
|显示一个指示当前时间的标记。该属性适用于时间网格显示模式。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`false`

|[[progressiveEventRendering]]progressiveEventRendering
|只要数据 provider 一加载事项，马上触发事项的渲染（显示）。

- `true` - 每个数据 provider 收到数据都触发渲染。会导致渲染多次。
- `false` - 等到所有数据 provider 都收到数据后，统一渲染。渲染次数少。
|`false`

|[[scrollTime]]scrollTime
|设置初始显示的特定时间位置。但是用户还是可以往回滚动查看该时间之前的事项。如果需要禁止用户回滚，则请使用 <<slotMinTime, slotMinTime>> 属性。

默认情况下，回滚时间会在日期范围变更后重新设置。如需禁用该功能，请设置 <<scrollTimeReset, scrollTimeReset>> 为 `false`。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`PT6h`

|[[scrollTimeReset]]scrollTimeReset
|设置日历是否在每次日期范围变更后自动调整到 <<scrollTime, scrollTime>> 设置的时间。

默认情况下，通过日历的方法或用户的操作使得日期的范围发生变更，日期滚动都会重置。如需禁用该功能，请设置为 `false`。
|`true`

|[[selectConstraintBusinessHoursEnabled]]selectConstraintBusinessHoursEnabled
|设置是否只能在一周的工作时间内选择。
也会遵循自定义工作时间的设置。

如果 <<selectionEnabled, selectionEnabled>> 属性启用，则会使用该属性。
|`false`

|[[selectConstraintGroupId]]selectConstraintGroupId
|设置一个 group ID 用于限制选择。此时，只能选择带有相同组 ID 事项的单元格。
优先级高于 <<selectConstraintBusinessHoursEnabled, selectConstraintBusinessHoursEnabled>>。

如果 <<selectionEnabled, selectionEnabled>> 属性启用，则会使用该属性。
|

|[[selectLongPressDelay]]selectLongPressDelay
|在触摸设备中，设置选择日期之前用户必须保持按下的时间。
|`1000`

|[[selectMinDistance]]selectMinDistance
|设置用户在按下鼠标后到允许选择之前必须移动的最小距离。设置一个非零值可以有效区分用户是要进行选择还是点击。

该属性仅可用于鼠标相关的交互。触控交互，请参阅 <<selectLongPressDelay, selectLongPressDelay>>。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`0`

|[[selectMirror]]selectMirror
|在用户拖动时绘制占位符事项。此属性适用于时间网格显示模式。
|`false`

|[[selectOverlap]]selectOverlap
|可选择包含事项的单元格。
|`true`

|[[selectionEnabled]]selectionEnabled
|用户可以通过点击和拖动的方式高亮多个日期或时间段。
|`false`

|[[slotDuration]]slotDuration
|设置时间段的间隔时长。

在 XML 组件定义中，属性值需遵循 `java.time.Duration` 类使用的 ISO-8601 时长格式。
|`PT30m`

|[[slotLabelInterval]]slotLabelInterval
|设置标记时间段文本的间隔。如果未设置，则会根据 <<slotDuration, slotDuration>> 自动计算一个合理的值。

当设置该属性为 `1 hour` 时，仅在整点显示时间标记，即使 <<slotDuration, slotDuration>> 设置为 `15` 或 `30` 分钟。

在 XML 组件定义中，属性值需遵循 `java.time.Duration` 类使用的 ISO-8601 时长格式。
|-

|[[slotMaxTime]]slotMaxTime
|设置每天显示的最后一个时间段。设置的值是一个开区间值，也就是说，不会包含结束时间等于该值的时间段。该属性定义最后一个时段，不考虑滚动条的位置。

在 XML 组件定义中，属性值需遵循 `java.time.Duration` 类使用的 ISO-8601 时长格式。
|`PT24h`

|[[slotMinTime]]slotMinTime
|设置每天显示的第一个时间段。该属性定义第一个时段，不考虑滚动条的位置。

在 XML 组件定义中，属性值需遵循 `java.time.Duration` 类使用的 ISO-8601 时长格式。
|`PT0h`

|[[snapDuration]]snapDuration
|设置一个拖动事项时，事项与坐标轴对齐的间隔。影响选择的粒度。

在 XML 组件定义中，属性值需遵循 `java.time.Duration` 类使用的 ISO-8601 时长格式。
|`PT30m`

|[[timeHint]]timeHint
|在列表显示模式中，为不可见的表头设置带有日期和时间的列名。
|-

|[[unselectAuto]]unselectAuto
|设置是否可以通过点击其他地方取消选择。仅在 <<selectionEnabled, selectionEnabled>> 为 `true` 时有效。

在组件 attach 到 UI 后，该属性的更改不会生效。
|`true`

|[[unselectCancelSelector]]unselectCancelSelector
|设置 CSS 选择器，这些元素将忽略 <<unselectAuto, unselectAuto>> 属性。示例：

`vaadin-form-layout .custom-text-input`

在组件 attach 到 UI 后，该属性的更改不会生效。
|-

|[[weekNumbersVisible]]weekNumbersVisible
|设置是否显示星期数。
|`false`

|[[weekTextLong]]weekTextLong
|星期的长名称。
|-

|[[weekendsVisible]]weekendsVisible
|设置在任何日历显示模式中是否包括星期六和星期日。
|`true`

|[[windowResizeDelay]]windowResizeDelay
|设置在调整窗口大小后调整日历大小之前将等待的延迟（以毫秒为单位）。
|`100`

|===

[[handlers]]
== 事件和处理器

在 Jmix 中，所有组件都有一些 xref:flow-ui:vc/common-handlers.adoc[通用事件和处理器]，可以按相同的方法设置。
下面是 `calendar` 的特殊事件和处理器：

include::flow-ui:vc/handler-generation-tip.adoc[]

[cols="1h,6a",grid=rows,frame=none]
|===
|*名称*|*描述*

|[[DateClickEvent]]DateClickEvent
|`io.jmix.fullcalendarflowui.component.event.DateClickEvent` 当点击日期或时间单元格发送。

|[[DatesSetEvent]]DatesSetEvent
|`io.jmix.fullcalendarflowui.component.event.DatesSetEvent` 在日历的日期范围第一次设置或通过某种方式更改且组件的 DOM 元素已经更新后发送。

日历的日期在用户做下面的操作时更改：

- 往前或往后跳转；
- 切换显示模式；
- 点击导航链接（例如在 <<navigationLinksEnabled, navigationLinksEnabled>> 为 `true` 时，点击星期或日期）。

或者通过 API 操作当前日期也能触发日期的变更。

|[[DayNavigationLinkClickEvent]]DayNavigationLinkClickEvent
|当用户点击日期表头导航时发送。导航链接可以通过 <<navigationLinksEnabled, navigationLinksEnabled>> 属性启用。

|[[EventClickEvent]]EventClickEvent
|`io.jmix.fullcalendarflowui.component.event.EventClickEvent` 当点击日历事项时发送。

|[[EventDropEvent]]EventDropEvent
|`io.jmix.fullcalendarflowui.component.event.EventDropEvent` 当停止拖动，且事项移至不同的日期或时段时发送。

|[[EventMouseEnterEvent]]EventMouseEnterEvent
|`io.jmix.fullcalendarflowui.component.event.EventMouseEnterEvent` 当用户鼠标悬停在日历事项时发送。

|[[EventMouseLeaveEvent]]EventMouseLeaveEvent
|`io.jmix.fullcalendarflowui.component.event.EventMouseLeaveEvent` 当用户鼠标移出日历事项时发送。

|[[EventResizeEvent]]EventResizeEvent
|`io.jmix.fullcalendarflowui.component.event.EventResizeEvent` 当停止调整大小，且事项的时长已经发生变更时发送。

|[[MoreLinkClickEvent]]MoreLinkClickEvent
|`io.jmix.fullcalendarflowui.component.event.MoreLinkClickEvent` 当用户点击 “more” 链接时发送。“more” 链接可通过下列属性启用：

- <<defaultDayMaxEventRowsEnabled, defaultDayMaxEventRowsEnabled>>
- <<dayMaxEventRows, dayMaxEventRows>>
- <<defaultDayMaxEventsEnabled, defaultDayMaxEventsEnabled>>
- <<dayMaxEvents, dayMaxEvents>>

|[[SelectEvent]]SelectEvent
|`io.jmix.fullcalendarflowui.component.event.SelectEvent` 当选择日期或时间时发送。

选择模式可以通过 <<selectionEnabled, selectionEnabled>> 属性启用。

|[[UnselectEvent]]UnselectEvent
|`io.jmix.fullcalendarflowui.component.event.UnselectEvent` 当清除当前选择时发送。已选择内容可以通过多种方式清除：

- 用户点击已选内容之外的其他地方（需启用 <<unselectAuto, unselectAuto>>）。
- 用户选择新内容。事件会在新选择发生之前发送。
- 用户在当前日历显示模式中向前或向后导航，或切换显示模式。
- 调用 `unselect()` 方法。

|[[WeekNavigationLinkClickEvent]]WeekNavigationLinkClickEvent
|当用户点击星期编号进行导航时发送。

导航链接可以通过 <<navigationLinksEnabled, navigationLinksEnabled>> 属性启用。

|[[dayCellBottomTextClassNamesGenerator]]dayCellBottomText-
ClassNamesGenerator
|为日期单元格的底部文字生成 CSS 类名。

请注意，仅当单元格的底部文本不为空时，才会调用生成器。

|[[dayCellBottomTextGenerator]]dayCellBottomTextGenerator
|生成日期单元格底部的文本。仅适用于日网格、月和年的显示模式。

请注意，在某些情况下，单元格中的事项可能会与底部的文本重叠。为避免这种情况，建议限制可见的事项数量。例如，可以使用 <<dayMaxEvents, dayMaxEvents>> 属性。

|[[dayCellClassNamesGenerator]]dayCellClassNamesGenerator
|为日期单元格生成 CSS 类名称。日期单元格在日网格和时间网格模式下显示为一个全天的单元格。

|[[dayHeaderClassNamesGenerator]]dayHeaderClassNamesGenerator
|为日期表头生成 CSS 类名称。日期表头是在某些显示模式下显示星期几和日期的单元格。

|[[moreLinkClassNamesGenerator]]moreLinkClassNamesGenerator
|为 “more” 链接生成 CSS 类名。

生成器的优先级高于其他设置 CSS 类名的方法。

|[[nowIndicatorClassNamesGenerator]]nowIndicatorClassNamesGenerator
|为“当前时间指示器”生成 CSS 类名。当前时间指示器由两部分组成：线和轴。

当前时间指示器可以通过 <<nowIndicatorVisible, nowIndicatorVisible>> 属性启用。

|[[slotLabelClassNamesGenerator]]slotLabelClassNamesGenerator
|为时间段标签生成 CSS 类名，该标签在时间网格模式下显示为带有时间标签的单元格。
|===

== XML 内部元素

`calendar` 的 XML 内部元素提供了更多的选项来控制组件的外观、行为、格式、数据绑定和其他功能。

[TIP]
====
如需通过 Studio 为选择的组件添加内部元素，可以点击 *Jmix UI* 组件属性面板的 xref:studio:screen-designer.adoc#component-inspector[Add] 按钮。
====

[[business-hours-element]]
=== businessHours

`businessHours` 是一个组元素，内部包含工作时间的条目。

[cols="1h,6",grid=none]
|===
|XML 元素
|`businessHours`

|XML 内部元素
|<<entry-element, entry>>
|===

[[entry-element]]
==== entry

工作时间的定义。

[cols="1h,6",grid=none]
|===
|XML 元素
|`entry`

|XML 内部元素
|<<day-element, day>>
|===

.XML 属性
[cols="1h,5a,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|endTime
|工作时间的结束时间。时间的值必须是 ISO-8601 时长的格式，由 `java.time.Duration` 类使用。示例：

* `"P9h"` - 9 个小时。
* `"PT18h30m"` - 18 小时 30 分钟。

|-

|startTime
|工作时间的开始时间。时间的值必须是 ISO-8601 时长的格式，由 `java.time.Duration` 类使用。示例：

* `"P9h"` - 9 个小时。
* `"PT18h30m"` - 18 小时 30 分钟。
|-
|===

[[custom-display-modes-element]]
=== customDisplayModes

`customDisplayModes` 是一个组元素，内部包含组件可以使用的自定义显示模式。

[cols="1h,6",grid=none]
|===
|XML 元素
|`customDisplayModes`

|XML 内部元素
|<<displayMode, displayMode>>
|===

==== displayMode

自定义显示模式的定义。

[cols="1h,6",grid=none]
|===
|XML 元素
|`displayMode`

|XML 内部元素
|<<duration, duration>> -
<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|id
|必需属性。用于设置初始或当前显示模式。
|-

|type
|自定义显示模式基于的类型。参阅 <<custom-calendar-display-mode>>。
| `DAY_GRID`

|dayCount
|自定义显示模式中显示的天数。
|-
|===

[[duration]]
==== duration

自定义日历显示模式的持续时间。

[cols="1h,6",grid=none]
|===
|XML 元素
|`duration`

|XML 内部元素
|-
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|days
|设置时长的天数
|0

|hours
|设置时长的小时数
|0

|milliseconds
|设置时长的毫秒数
|0

|minutes
|设置时长的分钟数
|0

|months
|设置时长的月数
|0

|seconds
|设置时长的秒数
|0

|weeks
|设置时长的星期数
|0

|years
|设置时长的年数
|0
|===

[[data-providers-element]]
=== dataProviders

`dataProviders` 是一个组元素，内部包含组件可以使用的数据 provider 的定义。

[cols="1h,6",grid=none]
|===
|XML 元素
|`dataProviders`

|XML 内部元素
|<<containerDataProvider, containerDataProvider>> -
<<container-data-provider-element, callbackDataProvider>>
|===

[[container-data-provider-element]]
==== containerDataProvider

`containerDataProvider` 是与数据容器绑定的数据 provider。其中可以定义实体属性和日历事项属性的映射。

[cols="1h,6",grid=none]
|===
|XML 元素
|`containerDataProvider`

|XML 内部元素
|-
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|id
|数据 provider 的标识符。
|-

|dataContainer
|同一个视图中数据容器的标识符。必需属性。
|-

|additionalProperties
|实体的额外属性。属性用逗号或空格隔开。

参阅日历事项的 <<additionalProperties, additionalProperties>>。
|-

|allDay
|实体中的 `allDay` 属性。

参阅日历事项的 <<allDay, allDay>> 属性。
|-

|backgroundColor
|实体中的 `backgroundColor` 属性。

参阅日历事项的 <<backgroundColor, backgroundColor>> 属性。
|-

|borderColor
|实体中的 `borderColor` 属性。


参阅日历事项的 <<borderColor, borderColor>> 属性。
|-

|classNames
|实体中的 `classNames` 属性。注意，实体的该属性需要是字符串类型，类名以空格隔开。

参阅日历事项的 <<classNames, classNames>> 属性。
|-

|constraint
|实体中的 `constraint` 属性。

参阅日历事项的 <<constraint, constraint>> 属性。
|-

|description
|实体中的 `description` 属性。

参阅日历事项的 <<description, description>> 属性。
|-

|display
|实体中的 `display` 属性。

参阅日历事项的 <<display, display>> 属性。
|-

|durationEditable
|实体中的 `durationEditable` 属性。

参阅日历事项的 <<durationEditable, durationEditable>> 属性。
|-

|endDateTime
|实体中的 `endDateTime` 属性。

参阅日历事项的 <<endDateTime, endDateTime>> 属性。
|-

|groupId
|实体中的 `groupId` 属性。

参阅日历事项的 <<groupId, groupId>> 属性。
|-

|interactive
|实体中的 `interactive` 属性。

参阅日历事项的 <<interactive, interactive>> 属性。
|-

|overlap
|实体中的 `overlap` 属性。

参阅日历事项的 <<overlap, overlap>> 属性。
|-

|recurringDaysOfWeek
|实体中的 `recurringDaysOfWeek` 属性。

参阅日历事项的 <<recurringDaysOfWeek, recurringDaysOfWeek>> 属性。
|-

|recurringEndDate
|实体中的 `recurringEndDate` 属性。

参阅日历事项的 <<recurringEndDate, recurringEndDate>> 属性。
|-

|recurringEndTime
|实体中的 `recurringEndTime` 属性。

参阅日历事项的 <<recurringEndTime, recurringEndTime>> 属性。
|-

|recurringStartDate
|实体中的 `recurringStartDate` 属性。

参阅日历事项的 <<recurringStartDate, recurringStartDate>> 属性。
|-

|recurringStartTime
|实体中的 `recurringStartTime` 属性。

参阅日历事项的 <<recurringStartTime, recurringStartTime>> 属性。
|-

|startDateTime
|实体中的 `startDateTime` 属性。

参阅日历事项的 <<startDateTime, startDateTime>> 属性。
|-

|startEditable
|实体中的 `startEditable` 属性。

参阅日历事项的 <<startEditable, startEditable>> 属性。
|-

|textColor
|实体中的 `textColor` 属性。

参阅日历事项的 <<textColor, textColor>> 属性。
|-

|title
|实体中的 `title` 属性。

参阅日历事项的 <<title, title>> 属性。
|-
|===

[[callback-data-provider-element]]
==== callbackDataProvider

`callbackDataProvider` 是一个使用 JPQL 或代理来加载实体的数据 provider。其中可以定义实体属性和日历事项属性的映射。

[cols="1h,6",grid=none]
|===
|XML 元素
|`callbackDataProvider`

|XML 内部元素
|<<items-query-element, itemsQuery>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|id
|数据 provider 的标识符。
|-

|additionalProperties
|实体的额外属性。属性用逗号或空格隔开。

参阅日历事项的 <<additionalProperties, additionalProperties>> 属性。
|-

|allDay
|实体中的 `allDay` 属性。

参阅日历事项的 <<allDay, allDay>> 属性。
|-

|backgroundColor
|实体中的 `backgroundColor` 属性。

参阅日历事项的 <<backgroundColor, backgroundColor>> 属性。
|-

|borderColor
|实体中的 `borderColor` 属性。

参阅日历事项的 <<borderColor, borderColor>> 属性。
|-

|classNames
|实体中的 `classNames` 属性。注意，实体的该属性需要是字符串类型，类名以空格隔开。

参阅日历事项的 <<classNames, classNames>> 属性。
|-

|constraint
|实体中的 `constraint` 属性。

参阅日历事项的 <<constraint, constraint>> 属性。
|-

|description
|实体中的 `description` 属性。

参阅日历事项的 <<description, description>> 属性。
|-

|display
|实体中的 `display` 属性。

参阅日历事项的 <<display, display>> 属性。
|-

|durationEditable
|实体中的 `durationEditable` 属性。

参阅日历事项的 <<durationEditable, durationEditable>> 属性。
|-

|endDateTime
|实体中的 `endDateTime` 属性。

参阅日历事项的 <<endDateTime, endDateTime>> 属性。
|-

|groupId
|实体中的 `groupId` 属性。

参阅日历事项的 <<groupId, groupId>> 属性。
|-

|interactive
|实体中的 `interactive` 属性。

参阅日历事项的 <<interactive, interactive>> 属性。
|-

|overlap
|实体中的 `overlap` 属性。

参阅日历事项的 <<overlap, overlap>> 属性。
|-

|recurringDaysOfWeek
|实体中的 `recurringDaysOfWeek` 属性。

参阅日历事项的 <<recurringDaysOfWeek, recurringDaysOfWeek>> 属性。
|-

|recurringEndDate
|实体中的 `recurringEndDate` 属性。

参阅日历事项的 <<recurringEndDate, recurringEndDate>> 属性。
|-

|recurringEndTime
|实体中的 `recurringEndTime` 属性。

参阅日历事项的 <<recurringEndTime, recurringEndTime>> 属性。
|-

|recurringStartDate
|实体中的 `recurringStartDate` 属性。

参阅日历事项的 <<recurringStartDate, recurringStartDate>> 属性。
|-

|recurringStartTime
|实体中的 `recurringStartTime` 属性。

参阅日历事项的 <<recurringStartTime, recurringStartTime>> 属性。
|-

|startDateTime
|实体中的 `startDateTime` 属性。

参阅日历事项的 <<startDateTime, startDateTime>> 属性。
|-

|startEditable
|实体中的 `startEditable` 属性。

参阅日历事项的 <<startEditable, startEditable>> 属性。
|-

|textColor
|实体中的 `textColor` 属性。

参阅日历事项的 <<textColor, textColor>> 属性。
|-

|title
|实体中的 `title` 属性。

参阅日历事项的 <<title, title>> 属性。
|-
|===

.事件和处理器
[cols="1h,6", grid=rows, caption=]
|===
|*名称*
|*描述*
|[[LoadDelegate]]LoadDelegate
|设置加载事项的代理。
|===

[[items-query-element]]
==== itemsQuery
`itemsQuery` 描述加载实体的 JPQL 语句。

[cols="1h,6",grid=none]
|===
|XML 元素
|`itemsQuery`

|XML 内部元素
|-
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|class
|实体类的全限定名称。
|-

|fetchPlan
|加载实体对象图的 fetch plan。
|-

|query
|JPQL 查询语句。
|-

|===

[[display-mode-properties-element]]
=== displayModeProperties

`displayModeProperties` 是一个组元素，内部包含所有预定义的显示模式元素，可以配置这些模式的属性。

[cols="1h,6",grid=none]
|===

|XML 元素
|`displayModeProperties`

|XML 内部元素
|<<day-grid-day-element, dayGridDay>> -
<<day-grid-week-element, dayGridWeek>> -
<<day-grid-month-element, dayGridMonth>> -
<<day-grid-year-element, dayGridYear>> -
<<time-grid-day-element, timeGridDay>> -
<<time-grid-week-element, timeGridWeek>> -
<<list-day-element, listDay>> -
<<list-week-element, listWeek>> -
<<list-month-element, listMonth>> -
<<list-year-element, listYear>> -
<<multi-month-year-element, multiMonthYear>> -
|===

[[day-grid-day-element]]
==== dayGridDay

<<dayGridDay, dayGridDay>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`dayGridDay`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`true`

|eventTimeFormat
|设置该显示模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[day-grid-week-element]]
==== dayGridWeek

<<dayGridWeek, dayGridWeek>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`dayGridWeek`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`false`

|eventTimeFormat
|设置该显示模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[day-grid-month-element]]
==== dayGridMonth

<<dayGridMonth, dayGridMonth>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`dayGridMonth`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`false`

|eventTimeFormat
|设置该模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|fixedWeekCount
|控制显示的星期数量。如果为 `true`，日历总是显示 6 星期的高度。如果为 `false`，日历根据月份的不同，显示 4、5 或 6 周。
|`true`

|showNonCurrentDates
|是否显示前月或后月的日期。
|`true`

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[day-grid-year-element]]
==== dayGridYear

<<dayGridYear, dayGridYear>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`dayGridYear`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`false`

|eventTimeFormat
|设置该模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|monthStartFormat
|设置每月第一个单元格中文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`MMMM` 会输出 `September`（`November`、`December` 等）。
|-

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[time-grid-day-element]]
==== timeGridDay

<<timeGridDay, timeGridDay>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`timeGridDay`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|allDaySlotVisible
|全天时隙是否显示在日历顶部。
|`true`

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`true`

|eventMinHeight
|设置事项的最小高度。
|`15`

|eventShortHeight
|当事项有“short”样式时，设置其高度阈值。
|-

|eventTimeFormat
|设置该模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|slotEventOverlap
|时间事项是否可以重叠。
|`true`

|slotLabelFormat
|设置该显示模式下时隙标签的格式。格式规则与 <<defaultSlotLabelFormat, defaultSlotLabelFormat>> 相同。
|-

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[time-grid-week-element]]
==== timeGridWeek

<<timeGridWeek, timeGridWeek>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`timeGridWeek`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|allDaySlotVisible
|全天时隙是否显示在日历顶部。
|`true`

|dayHeaderFormat
|设置该显示模式中日期表头的格式。格式规则与 <<defaultDayHeaderFormat, defaultDayHeaderFormat>> 相同。
|-

|dayPopoverFormat
|设置该显示模式中弹出框的格式。格式规则与 <<defaultDayPopoverFormat, defaultDayPopoverFormat>> 相同。
|-

|displayEventEnd
|是否显示事项的结束时间。
|`true`

|eventMinHeight
|设置事项的最小高度。
|`15`

|eventShortHeight
|当事项有“short”样式时，设置其高度阈值。
|-

|eventTimeFormat
|设置该模式中事项时间的格式。格式规则与 <<defaultEventTimeFormat, defaultEventTimeFormat>> 相同。
|-

|slotEventOverlap
|时间事项是否可以重叠。
|`true`

|slotLabelFormat
|设置该显示模式下时隙标签的格式。格式规则与 <<defaultSlotLabelFormat, defaultSlotLabelFormat>> 相同。
|-

|weekNumberFormat
|设置该显示模式中星期的格式。格式规则与 <<defaultWeekNumberFormat, defaultWeekNumberFormat>> 相同。
|-
|===

[[list-day-element]]
==== listDay

<<listDay, listDay>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`listDay`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|listDayFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideFormat
|设置日期表头右侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideVisible
|设置日期表头右侧文本的可见性。
|`true`

|listDayVisible
|设置日期表头左侧文本的可见性。
|`true`
|===

[[list-week-element]]
==== listWeek

<<listWeek, listWeek>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`listWeek`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|listDayFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideVisible
|设置日期表头右侧文本的可见性。
|`true`

|listDayVisible
|设置日期表头左侧文本的可见性。
|`true`
|===

[[list-month-element]]
==== listMonth

<<listMonth, listMonth>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`listMonth`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|listDayFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideVisible
|设置日期表头右侧文本的可见性。
|`true`

|listDayVisible
|设置日期表头左侧文本的可见性。
|`true`
|===

[[list-year-element]]
==== listYear

<<listYear, listYear>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`listYear`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|listDayFormat
|设置日期表头左侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideFormat
|设置日期表头右侧文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`dd` 会输出 `Mo`（星期一）。
|-

|listDaySideVisible
|设置日期表头右侧文本的可见性。
|`true`

|listDayVisible
|设置日期表头左侧文本的可见性。
|`true`
|===

[[multi-month-year-element]]
==== multiMonthYear

<<multiMonthYear, multiMonthYear>> 显示模式的属性。

[cols="1h,6",grid=none]
|===
|XML 元素
|`multiMonthYear`

|XML 内部元素
|<<properties, properties>>
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|fixedWeekCount
|控制显示的星期数量。如果为 `true`，日历总是显示 6 星期的高度。如果为 `false`，日历根据月份的不同，显示 4、5 或 6 周。
|`true`

|multiMonthMaxColumns
|设置显示模式中尝试渲染的最大月数列。

默认情况下，显示模式会尝试显示 3 列迷你月。空间不足时，由于月的宽度不能小于 `multiMonthMinWidth`，则显示的列数会变少。
|`3`

|multiMonthMinWidth
|设置每个迷你月的最小宽度。渲染时，迷你月的宽度不能小时该设置。

如果可用空间不足，要求每个迷你月的宽度小于此像素值，则迷你月将换行显示。
|`350`

|multiMonthTitleFormat
|设置每个月上方文本的格式。默认情况下，组件从消息包获取本地化格式。

由于组件使用的 `FullCalendar` 用了 https://fullcalendar.io/docs/moment-plugin[moment 插件^]。因此设置格式时需要遵循 `moment.js` 的格式规则： https://momentjs.com/docs/#/displaying/format/[Moment.js 文档^]。
例如，`MMM` 会输出 `Sep`（`Nov`...）。
|

|showNonCurrentDates
|是否显示前月或后月的日期。
|`true`
|===

[[hidden-days-element]]
=== hiddenDays

`hiddenDays` 是一个组元素，包含每周需要在 `FullCalendar` 组件中隐藏的天数。

[cols="1h,6",grid=none]
|===
|XML 元素
|`hiddenDays`

|XML 内部元素
|<<day-element, day>>
|===

[[properties]]
=== properties

包含 `FullCalendar.js` 属性的组元素。

[cols="1h,6",grid=none]
|===
|XML 元素
|`properties`

|XML 内部元素
|<<property, property>>
|===

[[property]]
==== property

`FullCalendar.js` 属性的定义。

[cols="1h,6",grid=none]
|===
|XML 元素
|`property`

|XML 内部元素
|-
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|name
|属性名称。
|-

|value
|属性值。
|-
|===

[[day-element]]
=== day

该元素表示星期几。

[cols="1h,6",grid=none]
|===
|XML 元素
|`day`

|XML 内部元素
|-
|===

.XML 属性
[cols="1h,5,1",grid=rows,caption=]
|===
|*名称*
|*描述*
|*默认值*

|name
|星期几，例如 `MONDAY`、`TUESDAY` 等。
|-
|===

== 参考

https://fullcalendar.io/docs[FullCalendar 文档^]
