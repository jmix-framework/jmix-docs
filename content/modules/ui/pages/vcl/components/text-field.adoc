= TextField
:page-aliases: backoffice-ui:vcl/components/text-field.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/sampler/#main/sample?id=textfield-simple" class="live-demo-btn" target="_blank">ДЕМОНСТРАЦИЯ</a>
</div>
++++

`TextField` – это компонент для редактирования текста. Его можно использовать как для работы с атрибутами сущностей, так и для ввода/вывода произвольной текстовой информации.

XML-имя компонента:  `textField`.

[[basics]]
== Основы

Пример использования:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=simple-text-field]
----

image::vcl/components/simple-text-field.png[align="center"]

Что бы создать `TextField`, связанный с данными, используйте xref:vcl/xml.adoc#data-container[dataContainer] и атрибуты xref:vcl/xml.adoc#property[property].

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=data-aware-text-field]
----

В приведенном выше примере экран описывает контейнер данных `customerDc` для сущности `Customer`, которая имеет атрибут `firstName`. Компонент `TextField` имеет ссылку на контейнер, указанный в атрибуте `dataContainer`; атрибут `property` содержит имя атрибута сущности, отображаемого в  `TextField`.

[[attributes]]
== Атрибуты

[[data-type]]
=== datatype
Если поле не связано с атрибутом сущности (контейнер данных и имя атрибута не заданы), вы можете задать datatype с помощью атрибута `datatype`. Он используется для форматирования значений полей. Значение атрибута принимает любой зарегистрированный xref:data-model:data-types.adoc[datatype] в метаданных приложения.

Как правило, `TextField` используются следующие datatype:

* `decimal`
* `double`
* `int`
* `long`

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=integer-text-field]
----

[[max-length]]
=== maxLength

Если `TextField` связан с атрибутом сущности (посредством `dataContainer` и `property`), и если атрибут сущности имеет параметр длины, определенный в аннотации JPA `@Column`, тогда `TextField` ограничит максимальную длину вводимого текста соответственным образом.

Если `TextField` не связан с атрибутом, или если для атрибута не определено значение длины, или это значение необходимо переопределить, то максимальная длина вводимого текста может быть ограничена с помощью атрибута `maxLength`. Значение "-1" означает отсутствие ограничений. Например:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=short-text-field]
----

[[trim]]
=== trim

По умолчанию `TextField` обрезает пробелы в начале и в конце введенной строки. Например, если пользователь вводит "  aaa bbb  ", то значение поля, возвращаемое методом `getValue()` и сохраняемое в связанном атрибуте сущности, будет "aaa bbb". Вы можете отключить обрезку пробелов, установив для атрибута `trim` значение `false`.

Обратите внимание, что обрезка работает только тогда, когда пользователи вводят новое значение. Если значение связанного атрибута уже содержит пробелы, пробелы будут отображаться до тех пор, пока пользователь не отредактирует значение.

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=trim-text-field]
----

`TextField` всегда возвращает `null` вместо введенной пустой строки. Следовательно, при включенном атрибуте `trim` любая строка, содержащая только пробелы, будет преобразована в `null`.

[[html-name]]
=== htmlName

Устанавливает значение для атрибута `name` в HTML.

[[conversions]]
== Преобразования

[[case-conversion]]
=== Преобразование регистра

`TextField` поддерживает автоматическое преобразование регистра. Атрибут `caseConvertion` принимает одно из следующих значений:

* `UPPER` - верхний регистр.
* `LOWER` - нижний регистр.
* `NONE` -  без преобразования (значение по умолчанию). Используйте этот вариант для поддержки ввода последовательности клавиш с помощью IME (например, для японского, корейского или китайского языков).

[[data-type-conversion]]
=== Преобразование datatype

Если пользователь вводит значение, которое не может быть преобразовано в требуемый xref:data-model:data-types.adoc[datatype], отображается сообщение по умолчанию об ошибке преобразования.

Рассмотрим `TextField` с типом `Integer`:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=integer-text-field]
----

При вводе значения, которое нельзя интерпретировать как целое число, приложение выведет сообщение об ошибке по умолчанию.

image::vcl/components/integer-text-field.png[align="center"]

Сообщения об ошибках по умолчанию можно настроить глобально для проекта, как описано в разделе xref:data-model:data-types.adoc#conversion-error[Сообщения об ошибках преобразования].

[[conversion-error-message]]
Кроме того, вы можете использовать атрибут `conversionErrorMessage` для декларативного указания особого сообщения об ошибке преобразования в XML-дескрипторе экрана, например:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=conversion-text-field]
----

или программно в контроллере экрана:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=conversion-text-field]
----

[[validators-element]]
== Валидация

Для проверки введенных в компонент `TextField` значений можно использовать xref:vcl/miscellaneous/validator.adoc[validator] во вложенном элементе `validators`.

[[predefined-validators]]
Для `TextField` доступны следующие предопределенные валидаторы:

* xref:vcl/miscellaneous/validator.adoc#custom-validator[CustomValidator]
* xref:vcl/miscellaneous/validator.adoc#decimal-max-validator[DecimalMaxValidator]
* xref:vcl/miscellaneous/validator.adoc#decimal-min-validator[DecimalMinValidator]
* xref:vcl/miscellaneous/validator.adoc#digits-validator[DigitsValidator]
* xref:vcl/miscellaneous/validator.adoc#double-max-validator[DoubleMaxValidator]
* xref:vcl/miscellaneous/validator.adoc#double-min-validator[DoubleMinValidator]
* xref:vcl/miscellaneous/validator.adoc#email-validator[EmailValidator]
* xref:vcl/miscellaneous/validator.adoc#max-validator[MaxValidator]
* xref:vcl/miscellaneous/validator.adoc#min-validator[MinValidator]
* xref:vcl/miscellaneous/validator.adoc#negative-or-zero-validator[NegativeOrZeroValidator]
* xref:vcl/miscellaneous/validator.adoc#negative-validator[NegativeValidator]
* xref:vcl/miscellaneous/validator.adoc#not-blank-validator[NotBlankValidator]
* xref:vcl/miscellaneous/validator.adoc#not-empty-validator[NotEmptyValidator]
* xref:vcl/miscellaneous/validator.adoc#not-null-validator[NotNullValidator]
* xref:vcl/miscellaneous/validator.adoc#positive-or-zero-validator[PositiveOrZeroValidator]
* xref:vcl/miscellaneous/validator.adoc#positive-validator[PositiveValidator]
* xref:vcl/miscellaneous/validator.adoc#regexp-validator[RegexpValidator]
* xref:vcl/miscellaneous/validator.adoc#size-validator[SizeValidator]

В приведенном ниже примере показано использование `NegativeValidator`  для `textValidField`:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=validator]
----

[[styles]]
== Стили

Вы можете установить предопределенные стили для компонента `TextField`, используя атрибут `stylename` либо в дескрипторе XML, либо в контроллере экрана:

[source,xml,indent=0]
----
include::example$/ex1/src/main/resources/ui/ex1/screen/component/textfield/textField-screen.xml[tags=styled-text-field]
----

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=styled-text-field]
----

* `align-center` - выровнять текст внутри поля по центру.
* `align-right` - выровнять текст внутри поля по правому краю.
* `borderless` - убрать рамку и фон из текстового поля.
* `inline-icon` - переместить значок заголовка по умолчанию внутрь текстового поля.

[[methods]]
== Методы

* Можно использовать метод `setCursorPosition()`, чтобы сфокусировать поле и установить позицию курсора на указанный индекс, начинающийся с 0.

[[handlers]]
== События и слушатели

include::../events-hanlers-generation-tip.adoc[]

[[context-help-icon-click-event]]
=== ContextHelpIconClickEvent

См. xref:vcl/api.adoc#context-help-icon-click-handler[ContextHelpIconClickEvent].

[[enter-press-event]]
=== EnterPressEvent

См. xref:vcl/api.adoc#enter-press-event[EnterPressEvent].

[[formatter]]
=== Formatter

Добавляет экземпляр xref:vcl/miscellaneous/formatter.adoc[formatter] в компонент.

В приведенном ниже примере покажем использование `formatter` для текстового поля `customerField`:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=formatter]
----

Чтобы добавить форматтер программно, используйте метод компонента `setFormatter()`.

[[text-change-event]]
=== TextChangeEvent

`TextChangeEvent` отправляется, когда пользователь вводит что-либо в текстовое поле. Это событие обрабатывается асинхронно после ввода, чтобы не блокировать ввод.

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=text-field-change-event]
----

Чтобы создать слушателя события программно, используйте метод компонента `addTextChangeListener()`.

[[text-change-event-mode]]
`TextChangeEventMode` определяет способ передачи изменений на сервер, чтобы вызвать событие на стороне сервера. Есть 3 предопределенных режима события:

* `LAZY` (по умолчанию) - событие срабатывает при паузе в редактировании текста. Продолжительность паузы можно изменить с помощью `setInputEventTimeout()`.
* `TIMEOUT` - событие срабатывает по истечении тайм-аута. Длительность тайм-аута можно установить с помощью `setInputEventTimeout()`.
* `EAGER` - событие срабатывает немедленно при каждом изменении текстового содержимого, обычно вызванном нажатием клавиши.
* `BLUR` - событие срабатывает, когда текстовое поле теряет фокус.

[[text-change-timeout]]
Атрибут `textChangeTimeout` изменяет, как часто события передаются приложению, при `TextChangeEventMode` установленном в `LAZY` или `TIMEOUT`.

Чтобы создать слушателя события программно, используйте метод компонента `setTextChangeEventMode()`.

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=event-mode]
----

[[validator]]
=== Validator

Добавляет экземпляр xref:vcl/miscellaneous/validator.adoc[validator] к компоненту. `validator` должен выбросить `ValidationException`, если значение недопустимо.

Если вас не устраивают <<predefined-validators,предопределенные валидаторы>>, добавьте свой собственный экземпляр валидатора:

[source,java,indent=0]
----
include::example$/ex1/src/main/java/ui/ex1/screen/component/textfield/TextFieldScreen.java[tags=validator]
----

[[value-change-event]]
=== ValueChangeEvent

См. xref:vcl/api.adoc#value-change-event[ValueChangeEvent].

[[xml]]
== XML-атрибуты TextField

include::../xml-studio-tip.adoc[]

xref:vcl/xml.adoc#align[align] -
xref:vcl/xml.adoc#buffered[buffered] -
<<case-conversion, caseConversion>> -
xref:vcl/xml.adoc#caption[caption] -
xref:vcl/xml.adoc#caption-as-html[captionAsHtml] -
xref:vcl/xml.adoc#colspan[colspan] -
xref:vcl/xml.adoc#context-help-text[contextHelpText] -
xref:vcl/xml.adoc#context-help-text-html-enabled[contextHelpTextHtmlEnabled] -
<<conversion-error-message, conversionErrorMessage>> -
xref:vcl/xml.adoc#css[css] -
xref:vcl/xml.adoc#data-container[dataContainer] -
<<data-type, dataType>> -
xref:vcl/xml.adoc#description[description] -
xref:vcl/xml.adoc#description-as-html[descriptionAsHtml] -
xref:vcl/xml.adoc#editable[editable] -
xref:vcl/xml.adoc#enable[enable] -
xref:vcl/xml.adoc#box-expand-ratio[box.expandRatio] -
xref:vcl/xml.adoc#height[height] -
xref:vcl/xml.adoc#html-sanitizer-enabled[htmlSanitizerEnabled] -
<<html-name, htmlName>> -
xref:vcl/xml.adoc#icon[icon] -
xref:vcl/xml.adoc#id[id] -
xref:vcl/xml.adoc#input-prompt[inputPrompt] -
<<max-length, maxLength>> -
xref:vcl/xml.adoc#property[property] -
xref:vcl/xml.adoc#required[required] -
xref:vcl/xml.adoc#required-message[requiredMessage] -
xref:vcl/xml.adoc#responsive[responsive] -
xref:vcl/xml.adoc#rowspan[rowspan] -
xref:vcl/xml.adoc#stylename[stylename] -
xref:vcl/xml.adoc#tab-index[tabIndex] -
<<text-change-event-mode, textChangeEventMode>> -
<<text-change-timeout, textChangeTimeout>> -
<<trim, trim>> -
xref:vcl/xml.adoc#visible[visible] -
xref:vcl/xml.adoc#width[width]

== XML-элементы TextField

xref:vcl/miscellaneous/formatter.adoc[formatter] -
<<validators-element,validators>>