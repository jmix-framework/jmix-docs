= Export Actions

//Coming soon.

`ExportAction` is a base xref:flow-ui:actions/list-actions.adoc[list action] designed for exporting data grid contents using a specified exporter. An instance of xref:exporters.adoc[DataGridExporter] is required for this action.

This action can be configured for use with both xref:flow-ui:vc/components/dataGrid.adoc[] and xref:flow-ui:vc/components/treeDataGrid.adoc[] components.

Within `ExportAction`, there are methods available for managing functions that extract values from `DataGrid` columns:

* `addColumnValueProvider()` adds a function to retrieve values from a column.
* `removeColumnValueProvider()` removes a column value provider function by column `id`.

`ExportAction` has three export modes: all rows, the current page, and selected rows.

image::export-action.png[align="center",width="873"]

* The *All rows* option exports all records from the database taking into account applied filter and initial data loader query from the screen. Loading is performed using batches. The batch size may be configured using the xref:grid-export:properties.adoc#jmix.gridexport.exportAllBatchSize[jmix.gridexport.exportAllBatchSize] application property.
* The *Current page* option outputs only content of the current table's page.

The set of export options can be defined by a particular action using its `setAvailableExportModes()` method and corresponding `availableExportModes` property in XML. The default set of options is defined by the xref:properties.adoc#jmix.gridexport.default-export-modes[jmix.gridexport.default-export-modes] application property.

You can override the title and message of the dialog by adding messages with `actions.exportSelectedTitle` and `actions.exportSelectedCaption` keys to your xref:localization:message-bundles.adoc[message bundle].

// [[custom-action]]
// == Custom Export Action
//
// You can define a custom action inherited from `ExportAction`.
//
// An example of creating a custom export action:
//
// [source,java,indent=0]
// ----
// include::example$/ex1/src/main/java/gridexport/ex1/screen/exporter/CustomExportAction.java[tags=my-custom-action]
// ----
// <1> If needed, you can use a xref:exporters.adoc#custom-exporter[custom] table exporter.
//
// Now you can use the action in the screen controller:
//
// [source,java,indent=0]
// ----
// include::example$/ex1/src/main/java/gridexport/ex1/screen/customer/CustomerBrowse.java[tags=actions;application-context;customers-table;custom-btn;on-init-start;custom-action;on-init-end]
// ----
//
[[excel-export-action]]
== ExcelExportAction

`ExcelExportAction` is an action extending xref:actions.adoc[ExportAction] and designed to export the data grid content in XLSX format.

The action is implemented by the `io.jmix.gridexportflowui.action.ExcelExportAction` class and should be defined in XML using `type="grdexp_excelExport"` action’s attribute for a list component. You can configure common action parameters using XML attributes of the `action` element. See xref:flow-ui:actions/declarative-actions.adoc[Declarative Actions] for details.

For example:

[source,xml,indent=0]
----
include::example$/gridexport-ex1/src/main/resources/com/company/demo/view/customer/customer-list-view.xml[tags=actions;excelExport]
----

Alternatively, you can inject the action into the view controller and configure it using setters:

[source,java,indent=0]
----
include::example$/gridexport-ex1/src/main/java/com/company/demo/view/customer/CustomerListView.java[tags=excelExport;onInit]
----

You can override localized data format strings. The default set of format strings, defined for the excel export, is the following:

[source,properties]
----
excelExporter.label=Excel
excelExporter.true=Yes
excelExporter.false=No
excelExporter.empty=[Empty]
excelExporter.bytes=<bytes>
excelExporter.timeFormat=h:mm
excelExporter.dateFormat=m/d/yy
excelExporter.dateTimeFormat=m/d/yy h:mm
excelExporter.integerFormat=#,##0
excelExporter.doubleFormat=#,##0.00##############
----

[CAUTION]
====
The XLS format implies the limitation for 65536 table rows. If an exported data grid contains more than 65536 rows, its content will be cut by the last row, and you will see the corresponding warning message.
====

[[json-export-action]]
== JsonExportAction

`JsonExportAction` is an action extending xref:actions.adoc[ExportAction] and designed to export the data grid content in JSON format.

The action is implemented by the `io.jmix.gridexportflowui.action.JsonExportAction` class and should be defined in XML using `type="grdexp_jsonExport"` action’s attribute for a list component. You can configure common action parameters using XML attributes of the `action` element. See xref:flow-ui:actions/declarative-actions.adoc[Declarative Actions] for details.

For example:

[source,xml,indent=0]
----
include::example$/gridexport-ex1/src/main/resources/com/company/demo/view/customer/customer-list-view.xml[tags=actions;jsonExport]
----

Alternatively, you can inject the action into the view controller and configure it using setters:

[source,java,indent=0]
----
include::example$/gridexport-ex1/src/main/java/com/company/demo/view/customer/CustomerListView.java[tags=jsonExport;onInit]
----