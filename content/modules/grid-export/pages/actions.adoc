= 导出操作

`ExportAction` 是一个基本 xref:flow-ui:actions/list-actions.adoc[列操作]，通过特定的导出器导出表格的内容。此操作需要一个 xref:exporters.adoc[DataGridExporter] 实例。

此操作可用于 xref:flow-ui:vc/components/dataGrid.adoc[] 和 xref:flow-ui:vc/components/treeDataGrid.adoc[] 组件。

`ExportAction` 也提供从 `DataGrid` 的列获取导出值的方法：

* `addColumnValueProvider()` 添加一个方法，用于从列中获取导出值。
* `removeColumnValueProvider()` 通过列 `id` 删除一个获取列值的方法。

`ExportAction` 有三种导出模式：所有行、当前页以及选中行。

image::export-action.png[align="center",width="843"]

* 导出 *All rows（所有行）* 时，会按照视图中初始的数据加载器语句和过滤器的条件加载所有数据。过程中使用批量加载。每批次加载的数据量可以通过 xref:grid-export:properties.adoc#jmix.gridexport.exportAllBatchSize[jmix.gridexport.exportAllBatchSize] 应用程序属性配置。
* 导出 *Current page（当前页）* 时，仅导出表格当前页包含的数据。
* 导出 *Selected rows（选中行）* 时，仅导出表格选中的数据。

特定操作的导出选项可以通过 `setAvailableExportModes()` 方法或 XML 中的 `availableExportModes` 属性设置。默认的可用选项是通过 xref:properties.adoc#jmix.gridexport.default-export-modes[jmix.gridexport.default-export-modes] 应用程序属性定义。

可以在 xref:localization:message-bundles.adoc[消息包] 添加 `exportConfirmationDialog.header` 和 `exportConfirmationDialog.message` 消息覆盖默认的弹窗标题和文本。

[[excel-export-action]]
== ExcelExportAction

`ExcelExportAction` 操作继承了 `ExportAction` 用于以 XLSX 格式导出表格内容。

此操作由 `io.jmix.gridexportflowui.action.ExcelExportAction` 类实现，在 XML 中需要使用 `type="grdexp_excelExport"` 操作属性在列表组件定义。另外，该操作支持使用 `action` 元素的属性配置通用的操作参数。参阅 xref:flow-ui:actions/declarative-actions.adoc[声明式定义操作]。

示例：

[source,xml,indent=0]
----
include::example$/gridexport-ex1/src/main/resources/com/company/demo/view/customer/customer-list-view.xml[tags=actions;excelExport]
----

或者，可以在界面控制器注入该操作，然后用 setter 配置：

[source,java,indent=0]
----
include::example$/gridexport-ex1/src/main/java/com/company/demo/view/customer/CustomerListView.java[tags=excelExport;onInit]
----

可以覆盖本地化的数据格式字符串。Excel 导出的默认格式字符串定义如下：

[source,properties]
----
excelExporter.label=Excel
excelExporter.true=Yes
excelExporter.false=No
excelExporter.empty=[Empty]
excelExporter.bytes=<bytes>
excelExporter.timeFormat=h:mm
excelExporter.dateFormat=m/d/yy
excelExporter.dateTimeFormat=m/d/yy h:mm
excelExporter.integerFormat=#,##0
excelExporter.doubleFormat=#,##0.00##############
----

[[json-export-action]]
== JsonExportAction

`JsonExportAction` 操作继承了 `ExportAction` 用于以 JSON 格式导出表格内容。

此操作由 `io.jmix.gridexportflowui.action.JsonExportAction` 类实现，在 XML 中需要使用 `type="grdexp_jsonExport"` 操作属性在列表组件定义。另外，该操作支持使用 `action` 元素的属性配置通用的操作参数。参阅 xref:flow-ui:actions/declarative-actions.adoc[声明式定义操作]。

示例：

[source,xml,indent=0]
----
include::example$/gridexport-ex1/src/main/resources/com/company/demo/view/customer/customer-list-view.xml[tags=actions;jsonExport]
----

或者，可以在界面控制器注入该操作，然后用 setter 配置：

[source,java,indent=0]
----
include::example$/gridexport-ex1/src/main/java/com/company/demo/view/customer/CustomerListView.java[tags=jsonExport;onInit]
----

[[limatations]]
== 局限性

* 导出 `TreeDataGrid` 时，包含树层级属性的列不会有缩进。
* 不支持导出复合主键的实体。
