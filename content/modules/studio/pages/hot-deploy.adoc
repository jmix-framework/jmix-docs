= Hot Deploy

Jmix поддерживает технологию Hot Deploy, которая позволяет отображать сделанные в проекте изменения в работающем приложении без необходимости перезапускать сервер.

Hot deploy работает для следующих классов и ресурсов:

* Дескрипторы и контроллеры экранов;
* Классы, используемые контроллерами экранов через создание экземпляров или статические методы;
* Локализованные сообщения;
* Меню;
* Фетч-планы;
* Ресурсные роли;
* Роли уровня строк.

Hot deploy не работает для классов сущностей и бинов Spring.

Принцип работы Hot deploy следующий:

* Studio обнаруживает измененные файлы и
** если это файл ресурсов, Studio копирует его в каталог `.jmix/conf`;
** если это файл Java или Kotlin, Studio компилирует его и копирует файл класса в каталог `build/classes` проекта.
* Когда приложение открывает экран, фреймворк загружает новые классы и ресурсы из каталогов перечисленных выше.

Расположение каталога hot deploy ресурсов определяется свойством приложения xref:ROOT:app-properties.adoc#jmix.core.conf-dir[jmix.core.conf-dir]. Этот каталог очищается при запуске приложения действием *Before launch*, заданным в xref:studio:project.adoc#run-debug-configuration-settings[параметрах конфигурации Run/Debug].

Кроме того, Studio посылает приложению специальные сигналы, для того чтобы заставить его очистить кэши и перезагрузить измененные ресурсы. Это кэш локализованных сообщений и конфигурации представлений, зарегистрированных экранов и меню. Сигналы реализованы с помощью триггер-файлов, создаваемых в каталоге `.jmix/temp/triggers` (расположение может быть изменено с помощью свойства xref:ROOT:app-properties.adoc#jmix.core.temp-dir[jmix.core.temp-dir]).

NOTE: После сохранения изменений в Studio может потребоваться 2-3 секунды для того, чтобы приложение перезагрузило ресурсы и классы. Если после открытия экрана вы не увидели ожидаемых изменений, попробуйте обновить страницу браузера еще раз.

[[indicator]]
== Индикатор hot deploy

В Studio в правом верхнем углу файлов, поддерживающих hot deploy, отображается значок индикатора статуса. Этот значок, который виден на файлах, таких как контроллеры экранов, дескрипторы экранов, пакеты сообщений, роли и другие подобные ресурсы, позволяет мгновенно оценить текущий статус hot deploy для конкретного файла.

Основная задача этого индикатора - непрерывно информировать разработчиков о передаче последних изменений исходного кода в работающее приложение. Вид значка изменяется, чтобы отражать успешность развертывания изменений, процесс развертывания или возникновение ошибок в процессе развертывания, предоставляя немедленную визуальную обратную связь о состоянии hot deploy.

Рассмотрим различные состояния индикатора hot deploy.

. *Приложение не запущено*:
+
image::hot-deploy-ind-1.png[align="center",width="760"]
+
Индикатор имеет серые границы. При нажатии на индикатор появляется всплывающее сообщение с предложением запустить приложение.

. *Приложение запущено, изменения в файле отсутствуют*:
+
image::hot-deploy-ind-2.png[align="center",width="760"]
+
Индикатор имеет зеленые границы. При нажатии на индикатор появляется всплывающее сообщение, указывающее, что hot deploy для файла еще не выполнялся.

. *Файл изменен, hot deploy доступен*: Индикатор становится полностью зеленым. При нажатии на индикатор появляется всплывающее сообщение с предложением запустить hot deploy.
+
image::hot-deploy-ind-3.png[align="center",width="760"]
+
После запуска hot deploy индикатор остается полностью зеленым, а во всплывающем сообщении отображается время последнего hot deploy:
+
image::hot-deploy-ind-4.png[align="center",width="333"]

. *Hot deploy не удался*: Индикатор становится красным, указывая на то, что hot deploy не удался из-за ошибки компиляции или другой проблемы.
+
image::hot-deploy-ind-5.png[align="center",width="760"]