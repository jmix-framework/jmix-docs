= 导出 XLS

// ++++
// <div class="jmix-ui-live-demo-container">
//     <a href="https://demo.jmix.io/ui-samples/sample/pivot-table-export" class="live-demo-btn" target="_blank">在线示例</a>
// </div>
// ++++

`PivotTableExporter` bean 提供了一个 API，支持以 XLS（Excel）格式下载带聚合数据的透视表。

使用 `PivotTableExporter` 时，需要在视图控制器中创建一个该 bean 的实例。传递以下参数：

• `PivotTable`：需要导出的 `pivotTable` 组件。
• `PivotTableExcelExporter`：一个 `PivotTableExcelExporter` 实例，负责导出 Excel。

下面是在视图控制器使用 `PivotTableExporter` 的示例：

[source,java,indent=0]
----
include::../examples/pivottable-ex1/src/main/java/com/company/ex1/view/pivottableexport/PivottableExportView.java[tags=onInit;export]
----

NOTE: 导出功能目前支持以下 xref:pivot-table:pivottable-component.adoc#using-renderers[渲染器] 类型：`TABLE`、`TABLE_BAR_CHART`、`HEATMAP`、`COL_HEATMAP` 和 `ROW_HEATMAP`。请务必注意，不会导出单元格的颜色。

`exportTableToXls()` 方法提供一种将表格数据以 XLS（Excel）格式下载的方式。通常由 UI 中的按钮点击触发。示例：

[source,java,indent=0]
----
include::../examples/pivottable-ex1/src/main/java/com/company/ex1/view/pivottableexport/PivottableExportView.java[tags=run-export]
----

CAUTION: XLS 格式限制最大行数为 65536。如果透视表包含超过这个数量的行数，则仅能导出 65536 行，并显示警告消息。
