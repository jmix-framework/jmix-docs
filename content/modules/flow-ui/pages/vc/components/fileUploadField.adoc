= fileUploadField 单文件上传
:page-aliases: vcl/components/file-upload-field.adoc

++++
<div class="jmix-ui-live-demo-container">
    <a href="https://demo.jmix.io/ui-samples/sample/file-upload-field" class="live-demo-btn" target="_blank">在线示例</a>
</div>
++++

`fileUploadField` 支持从本地选择一个文件上传至 Jmix 应用程序。

* XML 元素：`fileUploadField`

* Java 类：`FileUploadField`

== 基本用法

这个控件可以包含标题、已上传文件的链接和一个上传按钮。当点击上传按钮的时候，会弹出标准的文件选择器，用户可以在这里选择需要上传的文件。

image::visual-components/components/file-upload-field-basics.gif[align="center"]

`fileUploadField` 既可以 <<data-binding,绑定实体属性>>，也可以不绑定数据。

下面的示例我们展示在没有数据绑定的情况下使用组件。可以用来直接处理上传的文件，而无需将其与任何 Jmix 实体关联。典型的使用场景是需要处理文件、将其保存到其他位置或执行某些其他操作而不进行持久化存储。

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/fileuploadfield/file-upload-field-view.xml[tags=basics-0]
----

[[FileUploadSucceededEvent-example]]
可以直接在 `FileUploadSucceededEvent` 事件中处理上传的文件。

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/view/component/fileuploadfield/FileUploadFieldView.java[tags=FileUploadSucceededEvent]
----

NOTE: 默认情况下，`fileUploadField` 使用 `MemoryBuffer` 作为文件 `Receiver`。也就是说，上传的文件以字符数组的形式保存在内存中。使用 `MemoryBuffer` 时并没有在文件系统创建任何物理文件。因此在处理不需要持久化存储的小文件时特别方便。

[TIP]
====
上传和保存大文件时，建议使用 xref:flow-ui:vc/components/fileStorageUploadField.adoc[fileStorageUploadField] 组件。

如需同时上传多个文件，请使用 xref:flow-ui:vc/components/upload.adoc[upload] 组件。
====

[[data-binding]]
== 数据绑定

`fileUploadField` 支持用户上传文件并以字符数组的格式保存在实体属性中。

下面例子中，`User` 实体的 `document` 属性是字节数组类型。

[source,java,indent=0]
----
include::example$/onboarding/src/main/java/com/company/onboarding/entity/User.java[tags=document]
----

[source,xml,indent=0]
----
include::example$/onboarding/src/main/resources/com/company/onboarding/view/component/fileuploadfield/file-upload-field-view.xml[tags=data;layout;basics]
----

`fileUploadField` 的 `dataContainer` 属性设置为数据容器；而 `property` 属性设置为展示在 `fileUploadField` 组件的实体属性。

如需上传文件至文件存储，并使用 `FileRef` 类型作为实体属性，请使用 xref:flow-ui:vc/components/fileStorageUploadField.adoc[fileStorageUploadField] 组件。

== XML 属性

xref:vc/common-attributes.adoc#id[id] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#acceptedFileTypes[acceptedFileTypes] -
xref:vc/common-attributes.adoc#alignSelf[alignSelf] -
xref:vc/common-attributes.adoc#classNames[classNames] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#clearButtonAriaLabel[clearButtonAriaLabel] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#clearButtonVisible[clearButtonVisible] -
xref:vc/common-attributes.adoc#colspan[colspan] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#connectingStatusText[connectingStatusText] -
xref:vc/common-attributes.adoc#css[css] -
xref:vc/common-attributes.adoc#dataContainer[dataContainer] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#dropAllowed[dropAllowed] -
xref:vc/common-attributes.adoc#enabled[enabled] -
xref:vc/common-attributes.adoc#errorMessage[errorMessage] -
<<fileName,fileName>> -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#fileNameVisible[fileNameVisible] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#fileNotSelectedText[fileNotSelectedText] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#fileTooBigText[fileTooBigText] -
xref:vc/common-attributes.adoc#height[height] -
xref:vc/common-attributes.adoc#helperText[helperText] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#incorrectFileTypeText[incorrectFileTypeText] -
xref:vc/common-attributes.adoc#label[label] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#maxFileSize[maxFileSize] -
xref:vc/common-attributes.adoc#maxHeight[maxHeight] -
xref:vc/common-attributes.adoc#maxWidth[maxWidth] -
xref:vc/common-attributes.adoc#minHeight[minHeight] -
xref:vc/common-attributes.adoc#minWidth[minWidth] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#processingStatusText[processingStatusText] -
xref:vc/common-attributes.adoc#property[property] -
xref:vc/common-attributes.adoc#readOnly[readOnly] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#remainingTimeText[remainingTimeText] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#remainingTimeUnknownText[remainingTimeUnknownText] -
xref:vc/common-attributes.adoc#required[required] -
xref:vc/common-attributes.adoc#requiredMessage[requiredMessage] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#uploadDialogCancelText[uploadDialogCancelText] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#uploadDialogTitle[uploadDialogTitle] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#uploadIcon[uploadIcon] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#uploadText[uploadText] -
xref:vc/common-attributes.adoc#visible[visible] -
xref:vc/common-attributes.adoc#width[width]

[[fileName]]
=== fileName

设置当组件值是从数据容器获得时的文本。用户上传文件后，控件应该显示文件名。但是，当值在数据库保存后，控件会丢失文件名信息。`fileName` 属性的作用就是在这种情况下可以显示自定义的内容。如果未设置该属性，则显示默认值：

image::visual-components/components/file-upload-field-file-name.png[align="center",width="283"]

== 事件和处理器

xref:vc/common-handlers.adoc#AttachEvent[AttachEvent] -
xref:vc/common-handlers.adoc#ComponentValueChangeEvent[ComponentValueChangeEvent] -
xref:vc/common-handlers.adoc#DetachEvent[DetachEvent] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#FileUploadFailedEvent[FileUploadFailedEvent] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#FileUploadFileRejectedEvent[FileUploadFileRejectedEvent] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#FileUploadFinishedEvent[FileUploadFinishedEvent] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#FileUploadProgressEvent[FileUploadProgressEvent] -
xref:flow-ui:vc/components/fileStorageUploadField.adoc#FileUploadStartedEvent[FileUploadStartedEvent] -
<<FileUploadSucceededEvent,FileUploadSucceededEvent>> -
xref:vc/common-handlers.adoc#statusChangeHandler[statusChangeHandler] -
xref:flow-ui:vc/components/textField.adoc#validator[validator]

include::../handler-generation-tip.adoc[]

[[FileUploadSucceededEvent]]
=== FileUploadSucceededEvent

`io.jmix.flowui.kit.component.upload.event.FileUploadSucceededEvent` 当 `Upload` 的 `SucceededEvent` 事件发生时触发。

参考上面基本用法里的 <<FileUploadSucceededEvent-example,示例>>。
